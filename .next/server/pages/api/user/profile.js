"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
(() => {
var exports = {};
exports.id = "pages/api/user/profile";
exports.ids = ["pages/api/user/profile"];
exports.modules = {

/***/ "next/dist/compiled/next-server/pages-api.runtime.dev.js":
/*!**************************************************************************!*\
  !*** external "next/dist/compiled/next-server/pages-api.runtime.dev.js" ***!
  \**************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/compiled/next-server/pages-api.runtime.dev.js");

/***/ }),

/***/ "@supabase/supabase-js":
/*!****************************************!*\
  !*** external "@supabase/supabase-js" ***!
  \****************************************/
/***/ ((module) => {

module.exports = import("@supabase/supabase-js");;

/***/ }),

/***/ "zod":
/*!**********************!*\
  !*** external "zod" ***!
  \**********************/
/***/ ((module) => {

module.exports = import("zod");;

/***/ }),

/***/ "(api)/../../node_modules/.pnpm/next@14.2.33_@babel+core@7._c7975f2ee2cecff60ee055e1f1f303a8/node_modules/next/dist/build/webpack/loaders/next-route-loader/index.js?kind=PAGES_API&page=%2Fapi%2Fuser%2Fprofile&preferredRegion=&absolutePagePath=.%2Fpages%5Capi%5Cuser%5Cprofile.ts&middlewareConfigBase64=e30%3D!":
/*!**********************************************************************************************************************************************************************************************************************************************************************************************************************!*\
  !*** ../../node_modules/.pnpm/next@14.2.33_@babel+core@7._c7975f2ee2cecff60ee055e1f1f303a8/node_modules/next/dist/build/webpack/loaders/next-route-loader/index.js?kind=PAGES_API&page=%2Fapi%2Fuser%2Fprofile&preferredRegion=&absolutePagePath=.%2Fpages%5Capi%5Cuser%5Cprofile.ts&middlewareConfigBase64=e30%3D! ***!
  \**********************************************************************************************************************************************************************************************************************************************************************************************************************/
/***/ ((module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.a(module, async (__webpack_handle_async_dependencies__, __webpack_async_result__) => { try {\n__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   config: () => (/* binding */ config),\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__),\n/* harmony export */   routeModule: () => (/* binding */ routeModule)\n/* harmony export */ });\n/* harmony import */ var next_dist_server_future_route_modules_pages_api_module_compiled__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/dist/server/future/route-modules/pages-api/module.compiled */ \"(api)/../../node_modules/.pnpm/next@14.2.33_@babel+core@7._c7975f2ee2cecff60ee055e1f1f303a8/node_modules/next/dist/server/future/route-modules/pages-api/module.compiled.js\");\n/* harmony import */ var next_dist_server_future_route_modules_pages_api_module_compiled__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_future_route_modules_pages_api_module_compiled__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! next/dist/server/future/route-kind */ \"(api)/../../node_modules/.pnpm/next@14.2.33_@babel+core@7._c7975f2ee2cecff60ee055e1f1f303a8/node_modules/next/dist/server/future/route-kind.js\");\n/* harmony import */ var next_dist_build_templates_helpers__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! next/dist/build/templates/helpers */ \"(api)/../../node_modules/.pnpm/next@14.2.33_@babel+core@7._c7975f2ee2cecff60ee055e1f1f303a8/node_modules/next/dist/build/templates/helpers.js\");\n/* harmony import */ var _pages_api_user_profile_ts__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./pages\\api\\user\\profile.ts */ \"(api)/./pages/api/user/profile.ts\");\nvar __webpack_async_dependencies__ = __webpack_handle_async_dependencies__([_pages_api_user_profile_ts__WEBPACK_IMPORTED_MODULE_3__]);\n_pages_api_user_profile_ts__WEBPACK_IMPORTED_MODULE_3__ = (__webpack_async_dependencies__.then ? (await __webpack_async_dependencies__)() : __webpack_async_dependencies__)[0];\n\n\n\n// Import the userland code.\n\n// Re-export the handler (should be the default export).\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ((0,next_dist_build_templates_helpers__WEBPACK_IMPORTED_MODULE_2__.hoist)(_pages_api_user_profile_ts__WEBPACK_IMPORTED_MODULE_3__, \"default\"));\n// Re-export config.\nconst config = (0,next_dist_build_templates_helpers__WEBPACK_IMPORTED_MODULE_2__.hoist)(_pages_api_user_profile_ts__WEBPACK_IMPORTED_MODULE_3__, \"config\");\n// Create and export the route module that will be consumed.\nconst routeModule = new next_dist_server_future_route_modules_pages_api_module_compiled__WEBPACK_IMPORTED_MODULE_0__.PagesAPIRouteModule({\n    definition: {\n        kind: next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__.RouteKind.PAGES_API,\n        page: \"/api/user/profile\",\n        pathname: \"/api/user/profile\",\n        // The following aren't used in production.\n        bundlePath: \"\",\n        filename: \"\"\n    },\n    userland: _pages_api_user_profile_ts__WEBPACK_IMPORTED_MODULE_3__\n});\n\n//# sourceMappingURL=pages-api.js.map\n__webpack_async_result__();\n} catch(e) { __webpack_async_result__(e); } });//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFwaSkvLi4vLi4vbm9kZV9tb2R1bGVzLy5wbnBtL25leHRAMTQuMi4zM19AYmFiZWwrY29yZUA3Ll9jNzk3NWYyZWUyY2VjZmY2MGVlMDU1ZTFmMWYzMDNhOC9ub2RlX21vZHVsZXMvbmV4dC9kaXN0L2J1aWxkL3dlYnBhY2svbG9hZGVycy9uZXh0LXJvdXRlLWxvYWRlci9pbmRleC5qcz9raW5kPVBBR0VTX0FQSSZwYWdlPSUyRmFwaSUyRnVzZXIlMkZwcm9maWxlJnByZWZlcnJlZFJlZ2lvbj0mYWJzb2x1dGVQYWdlUGF0aD0uJTJGcGFnZXMlNUNhcGklNUN1c2VyJTVDcHJvZmlsZS50cyZtaWRkbGV3YXJlQ29uZmlnQmFzZTY0PWUzMCUzRCEiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7Ozs7QUFBc0c7QUFDdkM7QUFDTDtBQUMxRDtBQUMyRDtBQUMzRDtBQUNBLGlFQUFlLHdFQUFLLENBQUMsdURBQVEsWUFBWSxFQUFDO0FBQzFDO0FBQ08sZUFBZSx3RUFBSyxDQUFDLHVEQUFRO0FBQ3BDO0FBQ08sd0JBQXdCLGdIQUFtQjtBQUNsRDtBQUNBLGNBQWMseUVBQVM7QUFDdkI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTCxZQUFZO0FBQ1osQ0FBQzs7QUFFRCxxQyIsInNvdXJjZXMiOlsid2VicGFjazovL3ZvaWNlLW9mLXVwc2EvP2MwNjgiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgUGFnZXNBUElSb3V0ZU1vZHVsZSB9IGZyb20gXCJuZXh0L2Rpc3Qvc2VydmVyL2Z1dHVyZS9yb3V0ZS1tb2R1bGVzL3BhZ2VzLWFwaS9tb2R1bGUuY29tcGlsZWRcIjtcbmltcG9ydCB7IFJvdXRlS2luZCB9IGZyb20gXCJuZXh0L2Rpc3Qvc2VydmVyL2Z1dHVyZS9yb3V0ZS1raW5kXCI7XG5pbXBvcnQgeyBob2lzdCB9IGZyb20gXCJuZXh0L2Rpc3QvYnVpbGQvdGVtcGxhdGVzL2hlbHBlcnNcIjtcbi8vIEltcG9ydCB0aGUgdXNlcmxhbmQgY29kZS5cbmltcG9ydCAqIGFzIHVzZXJsYW5kIGZyb20gXCIuL3BhZ2VzXFxcXGFwaVxcXFx1c2VyXFxcXHByb2ZpbGUudHNcIjtcbi8vIFJlLWV4cG9ydCB0aGUgaGFuZGxlciAoc2hvdWxkIGJlIHRoZSBkZWZhdWx0IGV4cG9ydCkuXG5leHBvcnQgZGVmYXVsdCBob2lzdCh1c2VybGFuZCwgXCJkZWZhdWx0XCIpO1xuLy8gUmUtZXhwb3J0IGNvbmZpZy5cbmV4cG9ydCBjb25zdCBjb25maWcgPSBob2lzdCh1c2VybGFuZCwgXCJjb25maWdcIik7XG4vLyBDcmVhdGUgYW5kIGV4cG9ydCB0aGUgcm91dGUgbW9kdWxlIHRoYXQgd2lsbCBiZSBjb25zdW1lZC5cbmV4cG9ydCBjb25zdCByb3V0ZU1vZHVsZSA9IG5ldyBQYWdlc0FQSVJvdXRlTW9kdWxlKHtcbiAgICBkZWZpbml0aW9uOiB7XG4gICAgICAgIGtpbmQ6IFJvdXRlS2luZC5QQUdFU19BUEksXG4gICAgICAgIHBhZ2U6IFwiL2FwaS91c2VyL3Byb2ZpbGVcIixcbiAgICAgICAgcGF0aG5hbWU6IFwiL2FwaS91c2VyL3Byb2ZpbGVcIixcbiAgICAgICAgLy8gVGhlIGZvbGxvd2luZyBhcmVuJ3QgdXNlZCBpbiBwcm9kdWN0aW9uLlxuICAgICAgICBidW5kbGVQYXRoOiBcIlwiLFxuICAgICAgICBmaWxlbmFtZTogXCJcIlxuICAgIH0sXG4gICAgdXNlcmxhbmRcbn0pO1xuXG4vLyMgc291cmNlTWFwcGluZ1VSTD1wYWdlcy1hcGkuanMubWFwIl0sIm5hbWVzIjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(api)/../../node_modules/.pnpm/next@14.2.33_@babel+core@7._c7975f2ee2cecff60ee055e1f1f303a8/node_modules/next/dist/build/webpack/loaders/next-route-loader/index.js?kind=PAGES_API&page=%2Fapi%2Fuser%2Fprofile&preferredRegion=&absolutePagePath=.%2Fpages%5Capi%5Cuser%5Cprofile.ts&middlewareConfigBase64=e30%3D!\n");

/***/ }),

/***/ "(api)/./lib/api/middleware/auth.ts":
/*!************************************!*\
  !*** ./lib/api/middleware/auth.ts ***!
  \************************************/
/***/ ((module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.a(module, async (__webpack_handle_async_dependencies__, __webpack_async_result__) => { try {\n__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   authenticate: () => (/* binding */ authenticate),\n/* harmony export */   checkRole: () => (/* binding */ checkRole),\n/* harmony export */   requireRole: () => (/* binding */ requireRole),\n/* harmony export */   withAuth: () => (/* binding */ withAuth),\n/* harmony export */   withRateLimit: () => (/* binding */ withRateLimit)\n/* harmony export */ });\n/* harmony import */ var _lib_database_server__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @/lib/database-server */ \"(api)/./lib/database-server.ts\");\nvar __webpack_async_dependencies__ = __webpack_handle_async_dependencies__([_lib_database_server__WEBPACK_IMPORTED_MODULE_0__]);\n_lib_database_server__WEBPACK_IMPORTED_MODULE_0__ = (__webpack_async_dependencies__.then ? (await __webpack_async_dependencies__)() : __webpack_async_dependencies__)[0];\n\n// Simple in-memory rate limiter (for production, use Redis or similar)\nconst rateLimitStore = new Map();\nfunction withRateLimit(maxRequests, windowMs, keyGenerator) {\n    return (req)=>{\n        const key = keyGenerator(req);\n        const now = Date.now();\n        const record = rateLimitStore.get(key);\n        if (!record || now > record.resetTime) {\n            rateLimitStore.set(key, {\n                count: 1,\n                resetTime: now + windowMs\n            });\n            return;\n        }\n        if (record.count >= maxRequests) {\n            const error = new Error(\"Too many requests\");\n            error.statusCode = 429;\n            error.code = \"RATE_LIMIT_EXCEEDED\";\n            throw error;\n        }\n        record.count++;\n    };\n}\nasync function authenticate(req) {\n    const authHeader = req.headers.authorization;\n    if (!authHeader || !authHeader.startsWith(\"Bearer \")) {\n        const error = new Error(\"No authorization token provided\");\n        error.statusCode = 401;\n        error.code = \"UNAUTHORIZED\";\n        throw error;\n    }\n    const token = authHeader.replace(\"Bearer \", \"\");\n    // Verify token with Supabase\n    const { data: { user }, error: authError } = await _lib_database_server__WEBPACK_IMPORTED_MODULE_0__.supabaseAdmin.auth.getUser(token);\n    if (authError || !user) {\n        const error = new Error(\"Invalid or expired token\");\n        error.statusCode = 401;\n        error.code = \"UNAUTHORIZED\";\n        throw error;\n    }\n    // Get user role from database\n    const { data: userData, error: userError } = await _lib_database_server__WEBPACK_IMPORTED_MODULE_0__.supabaseAdmin.from(\"users\").select(\"role\").eq(\"id\", user.id).single();\n    if (userError || !userData) {\n        const error = new Error(\"User not found in database\");\n        error.statusCode = 401;\n        error.code = \"UNAUTHORIZED\";\n        throw error;\n    }\n    return {\n        id: user.id,\n        email: user.email,\n        role: userData.role || \"user\"\n    };\n}\nasync function requireRole(req, allowedRoles) {\n    const user = await authenticate(req);\n    if (!allowedRoles.includes(user.role)) {\n        const error = new Error(\"Insufficient permissions\");\n        error.statusCode = 403;\n        error.code = \"FORBIDDEN\";\n        throw error;\n    }\n    return user;\n}\nfunction checkRole(userRole, allowedRoles) {\n    return allowedRoles.includes(userRole);\n}\nfunction withAuth(handler, options) {\n    return async (req, res)=>{\n        const user = await authenticate(req);\n        if (options?.requiredRole) {\n            const roles = Array.isArray(options.requiredRole) ? options.requiredRole : [\n                options.requiredRole\n            ];\n            if (!roles.includes(user.role)) {\n                const error = new Error(\"Insufficient permissions\");\n                error.statusCode = 403;\n                error.code = \"FORBIDDEN\";\n                throw error;\n            }\n        }\n        return handler(req, res, user);\n    };\n}\n\n__webpack_async_result__();\n} catch(e) { __webpack_async_result__(e); } });//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFwaSkvLi9saWIvYXBpL21pZGRsZXdhcmUvYXV0aC50cyIsIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7QUFDc0Q7QUFRdEQsdUVBQXVFO0FBQ3ZFLE1BQU1DLGlCQUFpQixJQUFJQztBQUVwQixTQUFTQyxjQUNkQyxXQUFtQixFQUNuQkMsUUFBZ0IsRUFDaEJDLFlBQTZDO0lBRTdDLE9BQU8sQ0FBQ0M7UUFDTixNQUFNQyxNQUFNRixhQUFhQztRQUN6QixNQUFNRSxNQUFNQyxLQUFLRCxHQUFHO1FBQ3BCLE1BQU1FLFNBQVNWLGVBQWVXLEdBQUcsQ0FBQ0o7UUFFbEMsSUFBSSxDQUFDRyxVQUFVRixNQUFNRSxPQUFPRSxTQUFTLEVBQUU7WUFDckNaLGVBQWVhLEdBQUcsQ0FBQ04sS0FBSztnQkFBRU8sT0FBTztnQkFBR0YsV0FBV0osTUFBTUo7WUFBUztZQUM5RDtRQUNGO1FBRUEsSUFBSU0sT0FBT0ksS0FBSyxJQUFJWCxhQUFhO1lBQy9CLE1BQU1ZLFFBQVEsSUFBSUMsTUFBTTtZQUN4QkQsTUFBTUUsVUFBVSxHQUFHO1lBQ25CRixNQUFNRyxJQUFJLEdBQUc7WUFDYixNQUFNSDtRQUNSO1FBRUFMLE9BQU9JLEtBQUs7SUFDZDtBQUNGO0FBRU8sZUFBZUssYUFBYWIsR0FBbUI7SUFDcEQsTUFBTWMsYUFBYWQsSUFBSWUsT0FBTyxDQUFDQyxhQUFhO0lBRTVDLElBQUksQ0FBQ0YsY0FBYyxDQUFDQSxXQUFXRyxVQUFVLENBQUMsWUFBWTtRQUNwRCxNQUFNUixRQUFRLElBQUlDLE1BQU07UUFDeEJELE1BQU1FLFVBQVUsR0FBRztRQUNuQkYsTUFBTUcsSUFBSSxHQUFHO1FBQ2IsTUFBTUg7SUFDUjtJQUVBLE1BQU1TLFFBQVFKLFdBQVdLLE9BQU8sQ0FBQyxXQUFXO0lBRTVDLDZCQUE2QjtJQUM3QixNQUFNLEVBQUVDLE1BQU0sRUFBRUMsSUFBSSxFQUFFLEVBQUVaLE9BQU9hLFNBQVMsRUFBRSxHQUFHLE1BQU03QiwrREFBYUEsQ0FBQzhCLElBQUksQ0FBQ0MsT0FBTyxDQUFDTjtJQUU5RSxJQUFJSSxhQUFhLENBQUNELE1BQU07UUFDdEIsTUFBTVosUUFBUSxJQUFJQyxNQUFNO1FBQ3hCRCxNQUFNRSxVQUFVLEdBQUc7UUFDbkJGLE1BQU1HLElBQUksR0FBRztRQUNiLE1BQU1IO0lBQ1I7SUFFQSw4QkFBOEI7SUFDOUIsTUFBTSxFQUFFVyxNQUFNSyxRQUFRLEVBQUVoQixPQUFPaUIsU0FBUyxFQUFFLEdBQUcsTUFBTWpDLCtEQUFhQSxDQUM3RGtDLElBQUksQ0FBQyxTQUNMQyxNQUFNLENBQUMsUUFDUEMsRUFBRSxDQUFDLE1BQU1SLEtBQUtTLEVBQUUsRUFDaEJDLE1BQU07SUFFVCxJQUFJTCxhQUFhLENBQUNELFVBQVU7UUFDMUIsTUFBTWhCLFFBQVEsSUFBSUMsTUFBTTtRQUN4QkQsTUFBTUUsVUFBVSxHQUFHO1FBQ25CRixNQUFNRyxJQUFJLEdBQUc7UUFDYixNQUFNSDtJQUNSO0lBRUEsT0FBTztRQUNMcUIsSUFBSVQsS0FBS1MsRUFBRTtRQUNYRSxPQUFPWCxLQUFLVyxLQUFLO1FBQ2pCQyxNQUFNUixTQUFTUSxJQUFJLElBQUk7SUFDekI7QUFDRjtBQUVPLGVBQWVDLFlBQVlsQyxHQUFtQixFQUFFbUMsWUFBc0I7SUFDM0UsTUFBTWQsT0FBTyxNQUFNUixhQUFhYjtJQUVoQyxJQUFJLENBQUNtQyxhQUFhQyxRQUFRLENBQUNmLEtBQUtZLElBQUksR0FBRztRQUNyQyxNQUFNeEIsUUFBUSxJQUFJQyxNQUFNO1FBQ3hCRCxNQUFNRSxVQUFVLEdBQUc7UUFDbkJGLE1BQU1HLElBQUksR0FBRztRQUNiLE1BQU1IO0lBQ1I7SUFFQSxPQUFPWTtBQUNUO0FBRU8sU0FBU2dCLFVBQVVDLFFBQWdCLEVBQUVILFlBQXNCO0lBQ2hFLE9BQU9BLGFBQWFDLFFBQVEsQ0FBQ0U7QUFDL0I7QUFFTyxTQUFTQyxTQUNkQyxPQUFxRyxFQUNyR0MsT0FBOEM7SUFFOUMsT0FBTyxPQUFPekMsS0FBcUIwQztRQUNqQyxNQUFNckIsT0FBTyxNQUFNUixhQUFhYjtRQUVoQyxJQUFJeUMsU0FBU0UsY0FBYztZQUN6QixNQUFNQyxRQUFRQyxNQUFNQyxPQUFPLENBQUNMLFFBQVFFLFlBQVksSUFBSUYsUUFBUUUsWUFBWSxHQUFHO2dCQUFDRixRQUFRRSxZQUFZO2FBQUM7WUFDakcsSUFBSSxDQUFDQyxNQUFNUixRQUFRLENBQUNmLEtBQUtZLElBQUksR0FBRztnQkFDOUIsTUFBTXhCLFFBQVEsSUFBSUMsTUFBTTtnQkFDeEJELE1BQU1FLFVBQVUsR0FBRztnQkFDbkJGLE1BQU1HLElBQUksR0FBRztnQkFDYixNQUFNSDtZQUNSO1FBQ0Y7UUFFQSxPQUFPK0IsUUFBUXhDLEtBQUswQyxLQUFLckI7SUFDM0I7QUFDRiIsInNvdXJjZXMiOlsid2VicGFjazovL3ZvaWNlLW9mLXVwc2EvLi9saWIvYXBpL21pZGRsZXdhcmUvYXV0aC50cz8wM2MxIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IE5leHRBcGlSZXF1ZXN0LCBOZXh0QXBpUmVzcG9uc2UgfSBmcm9tICduZXh0JztcclxuaW1wb3J0IHsgc3VwYWJhc2VBZG1pbiB9IGZyb20gJ0AvbGliL2RhdGFiYXNlLXNlcnZlcic7XHJcblxyXG5leHBvcnQgaW50ZXJmYWNlIEF1dGhlbnRpY2F0ZWRVc2VyIHtcclxuICBpZDogc3RyaW5nO1xyXG4gIGVtYWlsPzogc3RyaW5nO1xyXG4gIHJvbGU6IHN0cmluZztcclxufVxyXG5cclxuLy8gU2ltcGxlIGluLW1lbW9yeSByYXRlIGxpbWl0ZXIgKGZvciBwcm9kdWN0aW9uLCB1c2UgUmVkaXMgb3Igc2ltaWxhcilcclxuY29uc3QgcmF0ZUxpbWl0U3RvcmUgPSBuZXcgTWFwPHN0cmluZywgeyBjb3VudDogbnVtYmVyOyByZXNldFRpbWU6IG51bWJlciB9PigpO1xyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIHdpdGhSYXRlTGltaXQoXHJcbiAgbWF4UmVxdWVzdHM6IG51bWJlcixcclxuICB3aW5kb3dNczogbnVtYmVyLFxyXG4gIGtleUdlbmVyYXRvcjogKHJlcTogTmV4dEFwaVJlcXVlc3QpID0+IHN0cmluZ1xyXG4pIHtcclxuICByZXR1cm4gKHJlcTogTmV4dEFwaVJlcXVlc3QpID0+IHtcclxuICAgIGNvbnN0IGtleSA9IGtleUdlbmVyYXRvcihyZXEpO1xyXG4gICAgY29uc3Qgbm93ID0gRGF0ZS5ub3coKTtcclxuICAgIGNvbnN0IHJlY29yZCA9IHJhdGVMaW1pdFN0b3JlLmdldChrZXkpO1xyXG5cclxuICAgIGlmICghcmVjb3JkIHx8IG5vdyA+IHJlY29yZC5yZXNldFRpbWUpIHtcclxuICAgICAgcmF0ZUxpbWl0U3RvcmUuc2V0KGtleSwgeyBjb3VudDogMSwgcmVzZXRUaW1lOiBub3cgKyB3aW5kb3dNcyB9KTtcclxuICAgICAgcmV0dXJuO1xyXG4gICAgfVxyXG5cclxuICAgIGlmIChyZWNvcmQuY291bnQgPj0gbWF4UmVxdWVzdHMpIHtcclxuICAgICAgY29uc3QgZXJyb3IgPSBuZXcgRXJyb3IoJ1RvbyBtYW55IHJlcXVlc3RzJykgYXMgRXJyb3IgJiB7IHN0YXR1c0NvZGU/OiBudW1iZXI7IGNvZGU/OiBzdHJpbmcgfTtcclxuICAgICAgZXJyb3Iuc3RhdHVzQ29kZSA9IDQyOTtcclxuICAgICAgZXJyb3IuY29kZSA9ICdSQVRFX0xJTUlUX0VYQ0VFREVEJztcclxuICAgICAgdGhyb3cgZXJyb3I7XHJcbiAgICB9XHJcblxyXG4gICAgcmVjb3JkLmNvdW50Kys7XHJcbiAgfTtcclxufVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGF1dGhlbnRpY2F0ZShyZXE6IE5leHRBcGlSZXF1ZXN0KTogUHJvbWlzZTxBdXRoZW50aWNhdGVkVXNlcj4ge1xyXG4gIGNvbnN0IGF1dGhIZWFkZXIgPSByZXEuaGVhZGVycy5hdXRob3JpemF0aW9uO1xyXG5cclxuICBpZiAoIWF1dGhIZWFkZXIgfHwgIWF1dGhIZWFkZXIuc3RhcnRzV2l0aCgnQmVhcmVyICcpKSB7XHJcbiAgICBjb25zdCBlcnJvciA9IG5ldyBFcnJvcignTm8gYXV0aG9yaXphdGlvbiB0b2tlbiBwcm92aWRlZCcpIGFzIEVycm9yICYgeyBzdGF0dXNDb2RlPzogbnVtYmVyOyBjb2RlPzogc3RyaW5nIH07XHJcbiAgICBlcnJvci5zdGF0dXNDb2RlID0gNDAxO1xyXG4gICAgZXJyb3IuY29kZSA9ICdVTkFVVEhPUklaRUQnO1xyXG4gICAgdGhyb3cgZXJyb3I7XHJcbiAgfVxyXG5cclxuICBjb25zdCB0b2tlbiA9IGF1dGhIZWFkZXIucmVwbGFjZSgnQmVhcmVyICcsICcnKTtcclxuXHJcbiAgLy8gVmVyaWZ5IHRva2VuIHdpdGggU3VwYWJhc2VcclxuICBjb25zdCB7IGRhdGE6IHsgdXNlciB9LCBlcnJvcjogYXV0aEVycm9yIH0gPSBhd2FpdCBzdXBhYmFzZUFkbWluLmF1dGguZ2V0VXNlcih0b2tlbik7XHJcblxyXG4gIGlmIChhdXRoRXJyb3IgfHwgIXVzZXIpIHtcclxuICAgIGNvbnN0IGVycm9yID0gbmV3IEVycm9yKCdJbnZhbGlkIG9yIGV4cGlyZWQgdG9rZW4nKSBhcyBFcnJvciAmIHsgc3RhdHVzQ29kZT86IG51bWJlcjsgY29kZT86IHN0cmluZyB9O1xyXG4gICAgZXJyb3Iuc3RhdHVzQ29kZSA9IDQwMTtcclxuICAgIGVycm9yLmNvZGUgPSAnVU5BVVRIT1JJWkVEJztcclxuICAgIHRocm93IGVycm9yO1xyXG4gIH1cclxuXHJcbiAgLy8gR2V0IHVzZXIgcm9sZSBmcm9tIGRhdGFiYXNlXHJcbiAgY29uc3QgeyBkYXRhOiB1c2VyRGF0YSwgZXJyb3I6IHVzZXJFcnJvciB9ID0gYXdhaXQgc3VwYWJhc2VBZG1pblxyXG4gICAgLmZyb20oJ3VzZXJzJylcclxuICAgIC5zZWxlY3QoJ3JvbGUnKVxyXG4gICAgLmVxKCdpZCcsIHVzZXIuaWQpXHJcbiAgICAuc2luZ2xlKCk7XHJcblxyXG4gIGlmICh1c2VyRXJyb3IgfHwgIXVzZXJEYXRhKSB7XHJcbiAgICBjb25zdCBlcnJvciA9IG5ldyBFcnJvcignVXNlciBub3QgZm91bmQgaW4gZGF0YWJhc2UnKSBhcyBFcnJvciAmIHsgc3RhdHVzQ29kZT86IG51bWJlcjsgY29kZT86IHN0cmluZyB9O1xyXG4gICAgZXJyb3Iuc3RhdHVzQ29kZSA9IDQwMTtcclxuICAgIGVycm9yLmNvZGUgPSAnVU5BVVRIT1JJWkVEJztcclxuICAgIHRocm93IGVycm9yO1xyXG4gIH1cclxuXHJcbiAgcmV0dXJuIHtcclxuICAgIGlkOiB1c2VyLmlkLFxyXG4gICAgZW1haWw6IHVzZXIuZW1haWwsXHJcbiAgICByb2xlOiB1c2VyRGF0YS5yb2xlIHx8ICd1c2VyJ1xyXG4gIH07XHJcbn1cclxuXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiByZXF1aXJlUm9sZShyZXE6IE5leHRBcGlSZXF1ZXN0LCBhbGxvd2VkUm9sZXM6IHN0cmluZ1tdKTogUHJvbWlzZTxBdXRoZW50aWNhdGVkVXNlcj4ge1xyXG4gIGNvbnN0IHVzZXIgPSBhd2FpdCBhdXRoZW50aWNhdGUocmVxKTtcclxuXHJcbiAgaWYgKCFhbGxvd2VkUm9sZXMuaW5jbHVkZXModXNlci5yb2xlKSkge1xyXG4gICAgY29uc3QgZXJyb3IgPSBuZXcgRXJyb3IoJ0luc3VmZmljaWVudCBwZXJtaXNzaW9ucycpIGFzIEVycm9yICYgeyBzdGF0dXNDb2RlPzogbnVtYmVyOyBjb2RlPzogc3RyaW5nIH07XHJcbiAgICBlcnJvci5zdGF0dXNDb2RlID0gNDAzO1xyXG4gICAgZXJyb3IuY29kZSA9ICdGT1JCSURERU4nO1xyXG4gICAgdGhyb3cgZXJyb3I7XHJcbiAgfVxyXG5cclxuICByZXR1cm4gdXNlcjtcclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIGNoZWNrUm9sZSh1c2VyUm9sZTogc3RyaW5nLCBhbGxvd2VkUm9sZXM6IHN0cmluZ1tdKTogYm9vbGVhbiB7XHJcbiAgcmV0dXJuIGFsbG93ZWRSb2xlcy5pbmNsdWRlcyh1c2VyUm9sZSk7XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiB3aXRoQXV0aChcclxuICBoYW5kbGVyOiAocmVxOiBOZXh0QXBpUmVxdWVzdCwgcmVzOiBOZXh0QXBpUmVzcG9uc2UsIHVzZXI6IEF1dGhlbnRpY2F0ZWRVc2VyKSA9PiBQcm9taXNlPHZvaWQ+IHwgdm9pZCxcclxuICBvcHRpb25zPzogeyByZXF1aXJlZFJvbGU/OiBzdHJpbmcgfCBzdHJpbmdbXSB9XHJcbikge1xyXG4gIHJldHVybiBhc3luYyAocmVxOiBOZXh0QXBpUmVxdWVzdCwgcmVzOiBOZXh0QXBpUmVzcG9uc2UpID0+IHtcclxuICAgIGNvbnN0IHVzZXIgPSBhd2FpdCBhdXRoZW50aWNhdGUocmVxKTtcclxuICAgIFxyXG4gICAgaWYgKG9wdGlvbnM/LnJlcXVpcmVkUm9sZSkge1xyXG4gICAgICBjb25zdCByb2xlcyA9IEFycmF5LmlzQXJyYXkob3B0aW9ucy5yZXF1aXJlZFJvbGUpID8gb3B0aW9ucy5yZXF1aXJlZFJvbGUgOiBbb3B0aW9ucy5yZXF1aXJlZFJvbGVdO1xyXG4gICAgICBpZiAoIXJvbGVzLmluY2x1ZGVzKHVzZXIucm9sZSkpIHtcclxuICAgICAgICBjb25zdCBlcnJvciA9IG5ldyBFcnJvcignSW5zdWZmaWNpZW50IHBlcm1pc3Npb25zJykgYXMgRXJyb3IgJiB7IHN0YXR1c0NvZGU/OiBudW1iZXI7IGNvZGU/OiBzdHJpbmcgfTtcclxuICAgICAgICBlcnJvci5zdGF0dXNDb2RlID0gNDAzO1xyXG4gICAgICAgIGVycm9yLmNvZGUgPSAnRk9SQklEREVOJztcclxuICAgICAgICB0aHJvdyBlcnJvcjtcclxuICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIHJldHVybiBoYW5kbGVyKHJlcSwgcmVzLCB1c2VyKTtcclxuICB9O1xyXG59XHJcbiJdLCJuYW1lcyI6WyJzdXBhYmFzZUFkbWluIiwicmF0ZUxpbWl0U3RvcmUiLCJNYXAiLCJ3aXRoUmF0ZUxpbWl0IiwibWF4UmVxdWVzdHMiLCJ3aW5kb3dNcyIsImtleUdlbmVyYXRvciIsInJlcSIsImtleSIsIm5vdyIsIkRhdGUiLCJyZWNvcmQiLCJnZXQiLCJyZXNldFRpbWUiLCJzZXQiLCJjb3VudCIsImVycm9yIiwiRXJyb3IiLCJzdGF0dXNDb2RlIiwiY29kZSIsImF1dGhlbnRpY2F0ZSIsImF1dGhIZWFkZXIiLCJoZWFkZXJzIiwiYXV0aG9yaXphdGlvbiIsInN0YXJ0c1dpdGgiLCJ0b2tlbiIsInJlcGxhY2UiLCJkYXRhIiwidXNlciIsImF1dGhFcnJvciIsImF1dGgiLCJnZXRVc2VyIiwidXNlckRhdGEiLCJ1c2VyRXJyb3IiLCJmcm9tIiwic2VsZWN0IiwiZXEiLCJpZCIsInNpbmdsZSIsImVtYWlsIiwicm9sZSIsInJlcXVpcmVSb2xlIiwiYWxsb3dlZFJvbGVzIiwiaW5jbHVkZXMiLCJjaGVja1JvbGUiLCJ1c2VyUm9sZSIsIndpdGhBdXRoIiwiaGFuZGxlciIsIm9wdGlvbnMiLCJyZXMiLCJyZXF1aXJlZFJvbGUiLCJyb2xlcyIsIkFycmF5IiwiaXNBcnJheSJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(api)/./lib/api/middleware/auth.ts\n");

/***/ }),

/***/ "(api)/./lib/api/middleware/error-handler.ts":
/*!*********************************************!*\
  !*** ./lib/api/middleware/error-handler.ts ***!
  \*********************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   AuthenticationError: () => (/* binding */ AuthenticationError),\n/* harmony export */   ValidationError: () => (/* binding */ ValidationError),\n/* harmony export */   withErrorHandler: () => (/* binding */ withErrorHandler)\n/* harmony export */ });\nclass AuthenticationError extends Error {\n    constructor(message = \"Authentication required\"){\n        super(message);\n        this.statusCode = 401;\n        this.code = \"AUTHENTICATION_ERROR\";\n        this.name = \"AuthenticationError\";\n    }\n}\nclass ValidationError extends Error {\n    constructor(message = \"Invalid input data\"){\n        super(message);\n        this.statusCode = 400;\n        this.code = \"VALIDATION_ERROR\";\n        this.name = \"ValidationError\";\n    }\n}\nfunction withErrorHandler(handler) {\n    return async (req, res)=>{\n        try {\n            await handler(req, res);\n        } catch (error) {\n            console.error(\"API Error:\", error);\n            const statusCode = error && typeof error === \"object\" && \"statusCode\" in error ? error.statusCode : 500;\n            const message = error instanceof Error ? error.message : error && typeof error === \"object\" && \"message\" in error ? error.message : \"Internal Server Error\";\n            const code = error && typeof error === \"object\" && \"code\" in error ? error.code : \"INTERNAL_SERVER_ERROR\";\n            // Ensure we haven't already sent a response\n            if (!res.writableEnded) {\n                const response = {\n                    success: false,\n                    error: {\n                        code,\n                        message,\n                        details:  true && error instanceof Error ? error.stack : undefined\n                    },\n                    timestamp: new Date().toISOString()\n                };\n                res.status(statusCode).json(response);\n            }\n        }\n    };\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFwaSkvLi9saWIvYXBpL21pZGRsZXdhcmUvZXJyb3ItaGFuZGxlci50cyIsIm1hcHBpbmdzIjoiOzs7Ozs7QUFZTyxNQUFNQSw0QkFBNEJDO0lBSXZDQyxZQUFZQyxVQUFrQix5QkFBeUIsQ0FBRTtRQUN2RCxLQUFLLENBQUNBO2FBSlJDLGFBQWE7YUFDYkMsT0FBTztRQUlMLElBQUksQ0FBQ0MsSUFBSSxHQUFHO0lBQ2Q7QUFDRjtBQUVPLE1BQU1DLHdCQUF3Qk47SUFJbkNDLFlBQVlDLFVBQWtCLG9CQUFvQixDQUFFO1FBQ2xELEtBQUssQ0FBQ0E7YUFKUkMsYUFBYTthQUNiQyxPQUFPO1FBSUwsSUFBSSxDQUFDQyxJQUFJLEdBQUc7SUFDZDtBQUNGO0FBRU8sU0FBU0UsaUJBQWlCQyxPQUF1QjtJQUN0RCxPQUFPLE9BQU9DLEtBQXFCQztRQUNqQyxJQUFJO1lBQ0YsTUFBTUYsUUFBUUMsS0FBS0M7UUFDckIsRUFBRSxPQUFPQyxPQUFnQjtZQUN2QkMsUUFBUUQsS0FBSyxDQUFDLGNBQWNBO1lBRTVCLE1BQU1SLGFBQWFRLFNBQVMsT0FBT0EsVUFBVSxZQUFZLGdCQUFnQkEsUUFBU0EsTUFBTVIsVUFBVSxHQUFjO1lBQ2hILE1BQU1ELFVBQVVTLGlCQUFpQlgsUUFBUVcsTUFBTVQsT0FBTyxHQUNuRFMsU0FBUyxPQUFPQSxVQUFVLFlBQVksYUFBYUEsUUFBUSxNQUErQlQsT0FBTyxHQUFHO1lBQ3ZHLE1BQU1FLE9BQU9PLFNBQVMsT0FBT0EsVUFBVSxZQUFZLFVBQVVBLFFBQVNBLE1BQU1QLElBQUksR0FBYztZQUU5Riw0Q0FBNEM7WUFDNUMsSUFBSSxDQUFDTSxJQUFJRyxhQUFhLEVBQUU7Z0JBQ3RCLE1BQU1DLFdBQTZCO29CQUNqQ0MsU0FBUztvQkFDVEosT0FBTzt3QkFDTFA7d0JBQ0FGO3dCQUNBYyxTQUFTQyxLQUF5QixJQUFpQk4saUJBQWlCWCxRQUFRVyxNQUFNTyxLQUFLLEdBQUdDO29CQUM1RjtvQkFDQUMsV0FBVyxJQUFJQyxPQUFPQyxXQUFXO2dCQUNuQztnQkFFQVosSUFBSWEsTUFBTSxDQUFDcEIsWUFBWXFCLElBQUksQ0FBQ1Y7WUFDOUI7UUFDRjtJQUNGO0FBQ0YiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly92b2ljZS1vZi11cHNhLy4vbGliL2FwaS9taWRkbGV3YXJlL2Vycm9yLWhhbmRsZXIudHM/Njg4NCJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBOZXh0QXBpUmVxdWVzdCwgTmV4dEFwaVJlc3BvbnNlLCBOZXh0QXBpSGFuZGxlciB9IGZyb20gJ25leHQnO1xyXG5cclxuZXhwb3J0IGludGVyZmFjZSBBcGlFcnJvclJlc3BvbnNlIHtcclxuICBzdWNjZXNzOiBmYWxzZTtcclxuICBlcnJvcjoge1xyXG4gICAgY29kZTogc3RyaW5nO1xyXG4gICAgbWVzc2FnZTogc3RyaW5nO1xyXG4gICAgZGV0YWlscz86IHVua25vd247XHJcbiAgfTtcclxuICB0aW1lc3RhbXA6IHN0cmluZztcclxufVxyXG5cclxuZXhwb3J0IGNsYXNzIEF1dGhlbnRpY2F0aW9uRXJyb3IgZXh0ZW5kcyBFcnJvciB7XHJcbiAgc3RhdHVzQ29kZSA9IDQwMTtcclxuICBjb2RlID0gJ0FVVEhFTlRJQ0FUSU9OX0VSUk9SJztcclxuICBcclxuICBjb25zdHJ1Y3RvcihtZXNzYWdlOiBzdHJpbmcgPSAnQXV0aGVudGljYXRpb24gcmVxdWlyZWQnKSB7XHJcbiAgICBzdXBlcihtZXNzYWdlKTtcclxuICAgIHRoaXMubmFtZSA9ICdBdXRoZW50aWNhdGlvbkVycm9yJztcclxuICB9XHJcbn1cclxuXHJcbmV4cG9ydCBjbGFzcyBWYWxpZGF0aW9uRXJyb3IgZXh0ZW5kcyBFcnJvciB7XHJcbiAgc3RhdHVzQ29kZSA9IDQwMDtcclxuICBjb2RlID0gJ1ZBTElEQVRJT05fRVJST1InO1xyXG4gIFxyXG4gIGNvbnN0cnVjdG9yKG1lc3NhZ2U6IHN0cmluZyA9ICdJbnZhbGlkIGlucHV0IGRhdGEnKSB7XHJcbiAgICBzdXBlcihtZXNzYWdlKTtcclxuICAgIHRoaXMubmFtZSA9ICdWYWxpZGF0aW9uRXJyb3InO1xyXG4gIH1cclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIHdpdGhFcnJvckhhbmRsZXIoaGFuZGxlcjogTmV4dEFwaUhhbmRsZXIpIHtcclxuICByZXR1cm4gYXN5bmMgKHJlcTogTmV4dEFwaVJlcXVlc3QsIHJlczogTmV4dEFwaVJlc3BvbnNlKSA9PiB7XHJcbiAgICB0cnkge1xyXG4gICAgICBhd2FpdCBoYW5kbGVyKHJlcSwgcmVzKTtcclxuICAgIH0gY2F0Y2ggKGVycm9yOiB1bmtub3duKSB7XHJcbiAgICAgIGNvbnNvbGUuZXJyb3IoJ0FQSSBFcnJvcjonLCBlcnJvcik7XHJcblxyXG4gICAgICBjb25zdCBzdGF0dXNDb2RlID0gZXJyb3IgJiYgdHlwZW9mIGVycm9yID09PSAnb2JqZWN0JyAmJiAnc3RhdHVzQ29kZScgaW4gZXJyb3IgPyAoZXJyb3Iuc3RhdHVzQ29kZSBhcyBudW1iZXIpIDogNTAwO1xyXG4gICAgICBjb25zdCBtZXNzYWdlID0gZXJyb3IgaW5zdGFuY2VvZiBFcnJvciA/IGVycm9yLm1lc3NhZ2UgOiBcclxuICAgICAgICAoZXJyb3IgJiYgdHlwZW9mIGVycm9yID09PSAnb2JqZWN0JyAmJiAnbWVzc2FnZScgaW4gZXJyb3IgPyAoZXJyb3IgYXMgeyBtZXNzYWdlOiBzdHJpbmcgfSkubWVzc2FnZSA6ICdJbnRlcm5hbCBTZXJ2ZXIgRXJyb3InKTtcclxuICAgICAgY29uc3QgY29kZSA9IGVycm9yICYmIHR5cGVvZiBlcnJvciA9PT0gJ29iamVjdCcgJiYgJ2NvZGUnIGluIGVycm9yID8gKGVycm9yLmNvZGUgYXMgc3RyaW5nKSA6ICdJTlRFUk5BTF9TRVJWRVJfRVJST1InO1xyXG5cclxuICAgICAgLy8gRW5zdXJlIHdlIGhhdmVuJ3QgYWxyZWFkeSBzZW50IGEgcmVzcG9uc2VcclxuICAgICAgaWYgKCFyZXMud3JpdGFibGVFbmRlZCkge1xyXG4gICAgICAgIGNvbnN0IHJlc3BvbnNlOiBBcGlFcnJvclJlc3BvbnNlID0ge1xyXG4gICAgICAgICAgc3VjY2VzczogZmFsc2UsXHJcbiAgICAgICAgICBlcnJvcjoge1xyXG4gICAgICAgICAgICBjb2RlLFxyXG4gICAgICAgICAgICBtZXNzYWdlLFxyXG4gICAgICAgICAgICBkZXRhaWxzOiBwcm9jZXNzLmVudi5OT0RFX0VOViA9PT0gJ2RldmVsb3BtZW50JyAmJiBlcnJvciBpbnN0YW5jZW9mIEVycm9yID8gZXJyb3Iuc3RhY2sgOiB1bmRlZmluZWQsXHJcbiAgICAgICAgICB9LFxyXG4gICAgICAgICAgdGltZXN0YW1wOiBuZXcgRGF0ZSgpLnRvSVNPU3RyaW5nKCksXHJcbiAgICAgICAgfTtcclxuXHJcbiAgICAgICAgcmVzLnN0YXR1cyhzdGF0dXNDb2RlKS5qc29uKHJlc3BvbnNlKTtcclxuICAgICAgfVxyXG4gICAgfVxyXG4gIH07XHJcbn1cclxuIl0sIm5hbWVzIjpbIkF1dGhlbnRpY2F0aW9uRXJyb3IiLCJFcnJvciIsImNvbnN0cnVjdG9yIiwibWVzc2FnZSIsInN0YXR1c0NvZGUiLCJjb2RlIiwibmFtZSIsIlZhbGlkYXRpb25FcnJvciIsIndpdGhFcnJvckhhbmRsZXIiLCJoYW5kbGVyIiwicmVxIiwicmVzIiwiZXJyb3IiLCJjb25zb2xlIiwid3JpdGFibGVFbmRlZCIsInJlc3BvbnNlIiwic3VjY2VzcyIsImRldGFpbHMiLCJwcm9jZXNzIiwic3RhY2siLCJ1bmRlZmluZWQiLCJ0aW1lc3RhbXAiLCJEYXRlIiwidG9JU09TdHJpbmciLCJzdGF0dXMiLCJqc29uIl0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(api)/./lib/api/middleware/error-handler.ts\n");

/***/ }),

/***/ "(api)/./lib/database-server.ts":
/*!********************************!*\
  !*** ./lib/database-server.ts ***!
  \********************************/
/***/ ((module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.a(module, async (__webpack_handle_async_dependencies__, __webpack_async_result__) => { try {\n__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   supabaseAdmin: () => (/* binding */ supabaseAdmin)\n/* harmony export */ });\n/* harmony import */ var _supabase_supabase_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @supabase/supabase-js */ \"@supabase/supabase-js\");\nvar __webpack_async_dependencies__ = __webpack_handle_async_dependencies__([_supabase_supabase_js__WEBPACK_IMPORTED_MODULE_0__]);\n_supabase_supabase_js__WEBPACK_IMPORTED_MODULE_0__ = (__webpack_async_dependencies__.then ? (await __webpack_async_dependencies__)() : __webpack_async_dependencies__)[0];\n\nconst supabaseUrl = \"https://hewrjnconmykfzggwhzg.supabase.co\";\nconst supabaseServiceKey = process.env.SUPABASE_SERVICE_ROLE_KEY;\nif (!supabaseUrl) {\n    throw new Error(\"Missing NEXT_PUBLIC_SUPABASE_URL environment variable\");\n}\nif (!supabaseServiceKey) {\n    throw new Error(\"Missing SUPABASE_SERVICE_ROLE_KEY environment variable\");\n}\n// Create a Supabase client with the service role key for admin operations\nconst supabaseAdmin = (0,_supabase_supabase_js__WEBPACK_IMPORTED_MODULE_0__.createClient)(supabaseUrl, supabaseServiceKey, {\n    auth: {\n        autoRefreshToken: false,\n        persistSession: false\n    }\n});\n\n__webpack_async_result__();\n} catch(e) { __webpack_async_result__(e); } });//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFwaSkvLi9saWIvZGF0YWJhc2Utc2VydmVyLnRzIiwibWFwcGluZ3MiOiI7Ozs7Ozs7O0FBQXFEO0FBRXJELE1BQU1DLGNBQWNDLDBDQUFvQztBQUN4RCxNQUFNRyxxQkFBcUJILFFBQVFDLEdBQUcsQ0FBQ0cseUJBQXlCO0FBRWhFLElBQUksQ0FBQ0wsYUFBYTtJQUNoQixNQUFNLElBQUlNLE1BQU07QUFDbEI7QUFFQSxJQUFJLENBQUNGLG9CQUFvQjtJQUN2QixNQUFNLElBQUlFLE1BQU07QUFDbEI7QUFFQSwwRUFBMEU7QUFDbkUsTUFBTUMsZ0JBQWdCUixtRUFBWUEsQ0FBQ0MsYUFBYUksb0JBQW9CO0lBQ3pFSSxNQUFNO1FBQ0pDLGtCQUFrQjtRQUNsQkMsZ0JBQWdCO0lBQ2xCO0FBQ0YsR0FBRyIsInNvdXJjZXMiOlsid2VicGFjazovL3ZvaWNlLW9mLXVwc2EvLi9saWIvZGF0YWJhc2Utc2VydmVyLnRzP2NkN2MiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgY3JlYXRlQ2xpZW50IH0gZnJvbSAnQHN1cGFiYXNlL3N1cGFiYXNlLWpzJztcclxuXHJcbmNvbnN0IHN1cGFiYXNlVXJsID0gcHJvY2Vzcy5lbnYuTkVYVF9QVUJMSUNfU1VQQUJBU0VfVVJMO1xyXG5jb25zdCBzdXBhYmFzZVNlcnZpY2VLZXkgPSBwcm9jZXNzLmVudi5TVVBBQkFTRV9TRVJWSUNFX1JPTEVfS0VZO1xyXG5cclxuaWYgKCFzdXBhYmFzZVVybCkge1xyXG4gIHRocm93IG5ldyBFcnJvcignTWlzc2luZyBORVhUX1BVQkxJQ19TVVBBQkFTRV9VUkwgZW52aXJvbm1lbnQgdmFyaWFibGUnKTtcclxufVxyXG5cclxuaWYgKCFzdXBhYmFzZVNlcnZpY2VLZXkpIHtcclxuICB0aHJvdyBuZXcgRXJyb3IoJ01pc3NpbmcgU1VQQUJBU0VfU0VSVklDRV9ST0xFX0tFWSBlbnZpcm9ubWVudCB2YXJpYWJsZScpO1xyXG59XHJcblxyXG4vLyBDcmVhdGUgYSBTdXBhYmFzZSBjbGllbnQgd2l0aCB0aGUgc2VydmljZSByb2xlIGtleSBmb3IgYWRtaW4gb3BlcmF0aW9uc1xyXG5leHBvcnQgY29uc3Qgc3VwYWJhc2VBZG1pbiA9IGNyZWF0ZUNsaWVudChzdXBhYmFzZVVybCwgc3VwYWJhc2VTZXJ2aWNlS2V5LCB7XHJcbiAgYXV0aDoge1xyXG4gICAgYXV0b1JlZnJlc2hUb2tlbjogZmFsc2UsXHJcbiAgICBwZXJzaXN0U2Vzc2lvbjogZmFsc2VcclxuICB9XHJcbn0pO1xyXG4iXSwibmFtZXMiOlsiY3JlYXRlQ2xpZW50Iiwic3VwYWJhc2VVcmwiLCJwcm9jZXNzIiwiZW52IiwiTkVYVF9QVUJMSUNfU1VQQUJBU0VfVVJMIiwic3VwYWJhc2VTZXJ2aWNlS2V5IiwiU1VQQUJBU0VfU0VSVklDRV9ST0xFX0tFWSIsIkVycm9yIiwic3VwYWJhc2VBZG1pbiIsImF1dGgiLCJhdXRvUmVmcmVzaFRva2VuIiwicGVyc2lzdFNlc3Npb24iXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(api)/./lib/database-server.ts\n");

/***/ }),

/***/ "(api)/./pages/api/user/profile.ts":
/*!***********************************!*\
  !*** ./pages/api/user/profile.ts ***!
  \***********************************/
/***/ ((module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.a(module, async (__webpack_handle_async_dependencies__, __webpack_async_result__) => { try {\n__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__)\n/* harmony export */ });\n/* harmony import */ var _lib_database_server__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @/lib/database-server */ \"(api)/./lib/database-server.ts\");\n/* harmony import */ var _lib_api_middleware_error_handler__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @/lib/api/middleware/error-handler */ \"(api)/./lib/api/middleware/error-handler.ts\");\n/* harmony import */ var _lib_api_middleware_auth__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @/lib/api/middleware/auth */ \"(api)/./lib/api/middleware/auth.ts\");\n/* harmony import */ var zod__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! zod */ \"zod\");\nvar __webpack_async_dependencies__ = __webpack_handle_async_dependencies__([_lib_database_server__WEBPACK_IMPORTED_MODULE_0__, _lib_api_middleware_auth__WEBPACK_IMPORTED_MODULE_2__, zod__WEBPACK_IMPORTED_MODULE_3__]);\n([_lib_database_server__WEBPACK_IMPORTED_MODULE_0__, _lib_api_middleware_auth__WEBPACK_IMPORTED_MODULE_2__, zod__WEBPACK_IMPORTED_MODULE_3__] = __webpack_async_dependencies__.then ? (await __webpack_async_dependencies__)() : __webpack_async_dependencies__);\n\n\n\n\n\n// Validation schemas\nconst profileUpdateSchema = zod__WEBPACK_IMPORTED_MODULE_3__.z.object({\n    name: zod__WEBPACK_IMPORTED_MODULE_3__.z.string().min(1, \"Name is required\").max(255, \"Name must not exceed 255 characters\"),\n    bio: zod__WEBPACK_IMPORTED_MODULE_3__.z.string().max(1000, \"Bio must not exceed 1000 characters\").optional().nullable(),\n    avatar_url: zod__WEBPACK_IMPORTED_MODULE_3__.z.string().url(\"Invalid avatar URL\").optional().nullable(),\n    website: zod__WEBPACK_IMPORTED_MODULE_3__.z.string().url(\"Invalid website URL\").optional().nullable(),\n    location: zod__WEBPACK_IMPORTED_MODULE_3__.z.string().max(255, \"Location must not exceed 255 characters\").optional().nullable(),\n    social_links: zod__WEBPACK_IMPORTED_MODULE_3__.z.record(zod__WEBPACK_IMPORTED_MODULE_3__.z.unknown()).optional(),\n    preferences: zod__WEBPACK_IMPORTED_MODULE_3__.z.record(zod__WEBPACK_IMPORTED_MODULE_3__.z.unknown()).optional()\n});\n// Rate limiting: 10 profile updates per hour per user\nconst rateLimitMiddleware = (0,_lib_api_middleware_auth__WEBPACK_IMPORTED_MODULE_2__.withRateLimit)(10, 60 * 60 * 1000, (req)=>{\n    const token = req.headers.authorization?.replace(\"Bearer \", \"\");\n    return token || req.socket.remoteAddress || \"unknown\";\n});\n// Input sanitization middleware\nconst sanitizeMiddleware = (req)=>{\n    const fields = [\n        \"name\",\n        \"bio\",\n        \"location\"\n    ];\n    fields.forEach((field)=>{\n        if (req.body[field]) {\n            req.body[field] = req.body[field].trim().replace(/[<>]/g, \"\") // Remove potential HTML tags\n            .replace(/javascript:/gi, \"\") // Remove javascript protocol\n            .replace(/on\\w+=/gi, \"\"); // Remove event handlers\n        }\n    });\n};\nasync function handler(req, res) {\n    // Authenticate user using the new middleware\n    const user = await (0,_lib_api_middleware_auth__WEBPACK_IMPORTED_MODULE_2__.authenticate)(req);\n    // GET - User profile\n    if (req.method === \"GET\") {\n        try {\n            // Get user profile from database\n            let profile = null;\n            const { data: profileData, error: profileError } = await _lib_database_server__WEBPACK_IMPORTED_MODULE_0__.supabaseAdmin.from(\"users\").select(\"*\").eq(\"id\", user.id).maybeSingle();\n            // Handle case where profile doesn't exist or table doesn't exist\n            if (profileError) {\n                // If table doesn't exist or permission denied, create fallback profile\n                if (profileError.code === \"PGRST116\" || profileError.code === \"42501\" || profileError.message?.includes(\"does not exist\") || profileError.message?.includes(\"permission denied\")) {\n                    const authRole = user.role;\n                    profile = {\n                        id: user.id,\n                        email: user.email || null,\n                        name: user.email?.split(\"@\")[0] || \"User\",\n                        role: authRole || \"user\",\n                        avatar_url: null,\n                        bio: null,\n                        website: null,\n                        location: null,\n                        social_links: {},\n                        preferences: {},\n                        is_active: true,\n                        last_login_at: new Date().toISOString(),\n                        email_verified: false,\n                        last_sign_in_at: new Date().toISOString(),\n                        created_at: new Date().toISOString(),\n                        updated_at: new Date().toISOString()\n                    };\n                } else if (profileError.code !== \"PGRST116\") {\n                    return res.status(500).json({\n                        success: false,\n                        error: {\n                            code: \"DATABASE_ERROR\",\n                            message: \"Failed to fetch user profile\",\n                            details: profileError.message\n                        },\n                        timestamp: new Date().toISOString()\n                    });\n                }\n            } else {\n                profile = profileData;\n            }\n            // If profile doesn't exist, try to create it\n            if (!profile) {\n                // eslint-disable-next-line @typescript-eslint/no-explicit-any\n                const { data: newProfile, error: createError } = await _lib_database_server__WEBPACK_IMPORTED_MODULE_0__.supabaseAdmin.from(\"users\").insert({\n                    id: user.id,\n                    email: user.email,\n                    name: user.email?.split(\"@\")[0] || \"User\",\n                    bio: null,\n                    avatar_url: null,\n                    website: null,\n                    location: null,\n                    social_links: {},\n                    preferences: {},\n                    role: \"user\",\n                    is_active: true,\n                    email_verified: false,\n                    last_sign_in_at: new Date().toISOString(),\n                    created_at: new Date().toISOString(),\n                    updated_at: new Date().toISOString()\n                }).select(\"*\").single();\n                if (createError) {\n                    // If it's a conflict, try to fetch existing profile\n                    if (createError.code === \"23505\" || createError.message?.includes(\"duplicate\")) {\n                        // eslint-disable-next-line @typescript-eslint/no-explicit-any\n                        const { data: existingProfile, error: fetchError } = await _lib_database_server__WEBPACK_IMPORTED_MODULE_0__.supabaseAdmin.from(\"users\").select(\"*\").eq(\"id\", user.id).single();\n                        if (!fetchError && existingProfile) {\n                            profile = existingProfile;\n                        } else {\n                            profile = {\n                                id: user.id,\n                                email: user.email || null,\n                                name: user.email?.split(\"@\")[0] || \"User\",\n                                role: \"user\",\n                                avatar_url: null,\n                                bio: null,\n                                website: null,\n                                location: null,\n                                social_links: {},\n                                preferences: {},\n                                is_active: true,\n                                last_login_at: new Date().toISOString(),\n                                email_verified: false,\n                                last_sign_in_at: new Date().toISOString(),\n                                created_at: new Date().toISOString(),\n                                updated_at: new Date().toISOString()\n                            };\n                        }\n                    } else {\n                        profile = {\n                            id: user.id,\n                            email: user.email || null,\n                            name: user.email?.split(\"@\")[0] || \"User\",\n                            role: \"user\",\n                            avatar_url: null,\n                            bio: null,\n                            website: null,\n                            location: null,\n                            social_links: {},\n                            preferences: {},\n                            is_active: true,\n                            last_login_at: new Date().toISOString(),\n                            email_verified: false,\n                            last_sign_in_at: new Date().toISOString(),\n                            created_at: new Date().toISOString(),\n                            updated_at: new Date().toISOString()\n                        };\n                    }\n                } else {\n                    profile = newProfile;\n                }\n            }\n            // Get user stats (with fallback)\n            let stats = {\n                articles_count: 0,\n                comments_count: 0,\n                total_views: 0,\n                total_likes: 0\n            };\n            if (profile) {\n                try {\n                    // eslint-disable-next-line @typescript-eslint/no-explicit-any\n                    const { data: userStats, error: statsError } = await _lib_database_server__WEBPACK_IMPORTED_MODULE_0__.supabaseAdmin.from(\"user_profile_stats\").select(\"articles_count, comments_count, total_views, total_likes\").eq(\"id\", user.id).maybeSingle();\n                    if (!statsError && userStats) {\n                        stats = userStats;\n                    }\n                } catch  {\n                // Stats table might not exist, use defaults\n                }\n            }\n            // Combine profile data with stats\n            const profileWithStats = {\n                ...profile,\n                article_count: stats.articles_count,\n                comment_count: stats.comments_count,\n                total_views: stats.total_views,\n                total_likes: stats.total_likes\n            };\n            // FINAL OVERRIDE: Ensure admin role from authentication takes precedence\n            if (user.role === \"admin\") {\n                profileWithStats.role = \"admin\";\n            }\n            return res.status(200).json({\n                success: true,\n                data: {\n                    profile: profileWithStats,\n                    stats: stats\n                },\n                timestamp: new Date().toISOString()\n            });\n        } catch (error) {\n            return res.status(500).json({\n                success: false,\n                error: {\n                    code: \"INTERNAL_SERVER_ERROR\",\n                    message: \"An unexpected error occurred while fetching profile\",\n                    details:  true ? error.message : 0\n                },\n                timestamp: new Date().toISOString()\n            });\n        }\n    }\n    // PUT - Update user profile\n    if (req.method === \"PUT\") {\n        try {\n            // Apply rate limiting\n            rateLimitMiddleware(req);\n            // Validate and sanitize input\n            profileUpdateSchema.parse(req.body);\n            sanitizeMiddleware(req);\n            const { name, bio, avatar_url, website, location, social_links, preferences } = req.body;\n            // Check if user exists in database\n            // eslint-disable-next-line @typescript-eslint/no-explicit-any\n            const { data: existingProfile } = await _lib_database_server__WEBPACK_IMPORTED_MODULE_0__.supabaseAdmin.from(\"users\").select(\"id\").eq(\"id\", user.id).single();\n            const updateData = {\n                name: name.trim(),\n                updated_at: new Date().toISOString()\n            };\n            // Optional fields\n            if (bio !== undefined) {\n                updateData.bio = typeof bio === \"string\" ? bio.trim() : null;\n            }\n            if (avatar_url !== undefined) {\n                updateData.avatar_url = avatar_url || null;\n            }\n            if (website !== undefined) {\n                updateData.website = website && typeof website === \"string\" ? website.trim() : null;\n            }\n            if (location !== undefined) {\n                updateData.location = location && typeof location === \"string\" ? location.trim() : null;\n            }\n            if (social_links !== undefined) {\n                updateData.social_links = typeof social_links === \"object\" ? social_links : {};\n            }\n            if (preferences !== undefined) {\n                updateData.preferences = typeof preferences === \"object\" ? preferences : {};\n            }\n            let result;\n            let profileError;\n            if (existingProfile) {\n                // Update existing profile\n                // eslint-disable-next-line @typescript-eslint/no-explicit-any\n                ({ data: result, error: profileError } = await _lib_database_server__WEBPACK_IMPORTED_MODULE_0__.supabaseAdmin.from(\"users\").update(updateData).eq(\"id\", user.id).select(\"*\").single());\n            } else {\n                // Create new profile\n                // eslint-disable-next-line @typescript-eslint/no-explicit-any\n                ({ data: result, error: profileError } = await _lib_database_server__WEBPACK_IMPORTED_MODULE_0__.supabaseAdmin.from(\"users\").insert({\n                    id: user.id,\n                    email: user.email,\n                    name: name.trim(),\n                    bio: bio?.trim() || null,\n                    avatar_url: avatar_url || null,\n                    website: website?.trim() || null,\n                    location: location?.trim() || null,\n                    social_links: social_links || {},\n                    preferences: preferences || {},\n                    role: \"user\",\n                    is_active: true,\n                    created_at: new Date().toISOString(),\n                    updated_at: new Date().toISOString()\n                }).select(\"*\").single());\n            }\n            if (profileError) {\n                return res.status(500).json({\n                    success: false,\n                    error: {\n                        code: \"PROFILE_UPDATE_FAILED\",\n                        message: \"Failed to update user profile\",\n                        details: profileError.message\n                    },\n                    timestamp: new Date().toISOString()\n                });\n            }\n            // Get updated stats\n            let stats = {\n                articles_count: 0,\n                comments_count: 0,\n                total_views: 0,\n                total_likes: 0\n            };\n            try {\n                // eslint-disable-next-line @typescript-eslint/no-explicit-any\n                const { data: userStats, error: statsError } = await _lib_database_server__WEBPACK_IMPORTED_MODULE_0__.supabaseAdmin.from(\"user_profile_stats\").select(\"*\").eq(\"id\", user.id).single();\n                if (!statsError && userStats) {\n                    stats = {\n                        articles_count: userStats.articles_count || 0,\n                        comments_count: userStats.comments_count || 0,\n                        total_views: userStats.total_views || 0,\n                        total_likes: userStats.total_likes || 0\n                    };\n                }\n            } catch  {\n            // Stats query failed, but don't fail the entire request\n            }\n            // Combine profile data with stats\n            const profileWithStats = {\n                ...result,\n                article_count: stats.articles_count,\n                comment_count: stats.comments_count,\n                total_views: stats.total_views,\n                total_likes: stats.total_likes\n            };\n            return res.status(200).json({\n                success: true,\n                data: {\n                    profile: profileWithStats,\n                    stats: stats\n                },\n                timestamp: new Date().toISOString()\n            });\n        } catch (error) {\n            console.error(\"Profile PUT error:\", error);\n            return res.status(500).json({\n                success: false,\n                error: {\n                    code: \"INTERNAL_SERVER_ERROR\",\n                    message: \"An unexpected error occurred while updating profile\",\n                    details:  true ? error.message : 0\n                },\n                timestamp: new Date().toISOString()\n            });\n        }\n    }\n    return res.status(405).json({\n        success: false,\n        error: {\n            code: \"METHOD_NOT_ALLOWED\",\n            message: \"Only GET and PUT methods are allowed\",\n            details: null\n        },\n        timestamp: new Date().toISOString()\n    });\n}\n// Wrap with error handler middleware\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ((0,_lib_api_middleware_error_handler__WEBPACK_IMPORTED_MODULE_1__.withErrorHandler)(handler));\n\n__webpack_async_result__();\n} catch(e) { __webpack_async_result__(e); } });//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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YWdlcy9hcGkvdXNlci9wcm9maWxlLnRzPzRlMjgiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgTmV4dEFwaVJlcXVlc3QsIE5leHRBcGlSZXNwb25zZSB9IGZyb20gJ25leHQnO1xyXG5pbXBvcnQgeyBzdXBhYmFzZUFkbWluIH0gZnJvbSAnQC9saWIvZGF0YWJhc2Utc2VydmVyJztcclxuaW1wb3J0IHsgd2l0aEVycm9ySGFuZGxlciB9IGZyb20gJ0AvbGliL2FwaS9taWRkbGV3YXJlL2Vycm9yLWhhbmRsZXInO1xyXG5pbXBvcnQgeyBhdXRoZW50aWNhdGUgfSBmcm9tICdAL2xpYi9hcGkvbWlkZGxld2FyZS9hdXRoJztcclxuaW1wb3J0IHsgd2l0aFJhdGVMaW1pdCB9IGZyb20gJ0AvbGliL2FwaS9taWRkbGV3YXJlL2F1dGgnO1xyXG5pbXBvcnQgeyB6IH0gZnJvbSAnem9kJztcclxuXHJcbi8vIFZhbGlkYXRpb24gc2NoZW1hc1xyXG5jb25zdCBwcm9maWxlVXBkYXRlU2NoZW1hID0gei5vYmplY3Qoe1xyXG4gIG5hbWU6IHouc3RyaW5nKCkubWluKDEsICdOYW1lIGlzIHJlcXVpcmVkJykubWF4KDI1NSwgJ05hbWUgbXVzdCBub3QgZXhjZWVkIDI1NSBjaGFyYWN0ZXJzJyksXHJcbiAgYmlvOiB6LnN0cmluZygpLm1heCgxMDAwLCAnQmlvIG11c3Qgbm90IGV4Y2VlZCAxMDAwIGNoYXJhY3RlcnMnKS5vcHRpb25hbCgpLm51bGxhYmxlKCksXHJcbiAgYXZhdGFyX3VybDogei5zdHJpbmcoKS51cmwoJ0ludmFsaWQgYXZhdGFyIFVSTCcpLm9wdGlvbmFsKCkubnVsbGFibGUoKSxcclxuICB3ZWJzaXRlOiB6LnN0cmluZygpLnVybCgnSW52YWxpZCB3ZWJzaXRlIFVSTCcpLm9wdGlvbmFsKCkubnVsbGFibGUoKSxcclxuICBsb2NhdGlvbjogei5zdHJpbmcoKS5tYXgoMjU1LCAnTG9jYXRpb24gbXVzdCBub3QgZXhjZWVkIDI1NSBjaGFyYWN0ZXJzJykub3B0aW9uYWwoKS5udWxsYWJsZSgpLFxyXG4gIHNvY2lhbF9saW5rczogei5yZWNvcmQoei51bmtub3duKCkpLm9wdGlvbmFsKCksXHJcbiAgcHJlZmVyZW5jZXM6IHoucmVjb3JkKHoudW5rbm93bigpKS5vcHRpb25hbCgpXHJcbn0pO1xyXG5cclxuLy8gUmF0ZSBsaW1pdGluZzogMTAgcHJvZmlsZSB1cGRhdGVzIHBlciBob3VyIHBlciB1c2VyXHJcbmNvbnN0IHJhdGVMaW1pdE1pZGRsZXdhcmUgPSB3aXRoUmF0ZUxpbWl0KDEwLCA2MCAqIDYwICogMTAwMCwgKHJlcSkgPT4ge1xyXG4gIGNvbnN0IHRva2VuID0gcmVxLmhlYWRlcnMuYXV0aG9yaXphdGlvbj8ucmVwbGFjZSgnQmVhcmVyICcsICcnKTtcclxuICByZXR1cm4gdG9rZW4gfHwgcmVxLnNvY2tldC5yZW1vdGVBZGRyZXNzIHx8ICd1bmtub3duJztcclxufSk7XHJcblxyXG4vLyBJbnB1dCBzYW5pdGl6YXRpb24gbWlkZGxld2FyZVxyXG5jb25zdCBzYW5pdGl6ZU1pZGRsZXdhcmUgPSAocmVxOiBOZXh0QXBpUmVxdWVzdCkgPT4ge1xyXG4gIGNvbnN0IGZpZWxkcyA9IFsnbmFtZScsICdiaW8nLCAnbG9jYXRpb24nXTtcclxuICBmaWVsZHMuZm9yRWFjaChmaWVsZCA9PiB7XHJcbiAgICBpZiAocmVxLmJvZHlbZmllbGRdKSB7XHJcbiAgICAgIHJlcS5ib2R5W2ZpZWxkXSA9IHJlcS5ib2R5W2ZpZWxkXVxyXG4gICAgICAgIC50cmltKClcclxuICAgICAgICAucmVwbGFjZSgvWzw+XS9nLCAnJykgLy8gUmVtb3ZlIHBvdGVudGlhbCBIVE1MIHRhZ3NcclxuICAgICAgICAucmVwbGFjZSgvamF2YXNjcmlwdDovZ2ksICcnKSAvLyBSZW1vdmUgamF2YXNjcmlwdCBwcm90b2NvbFxyXG4gICAgICAgIC5yZXBsYWNlKC9vblxcdys9L2dpLCAnJyk7IC8vIFJlbW92ZSBldmVudCBoYW5kbGVyc1xyXG4gICAgfVxyXG4gIH0pO1xyXG59O1xyXG5cclxuaW50ZXJmYWNlIFVzZXJQcm9maWxlIHtcclxuICBpZDogc3RyaW5nO1xyXG4gIGVtYWlsOiBzdHJpbmcgfCBudWxsO1xyXG4gIG5hbWU6IHN0cmluZztcclxuICByb2xlOiAndXNlcicgfCAnYWRtaW4nIHwgJ2VkaXRvcic7XHJcbiAgYXZhdGFyX3VybDogc3RyaW5nIHwgbnVsbDtcclxuICBiaW86IHN0cmluZyB8IG51bGw7XHJcbiAgd2Vic2l0ZTogc3RyaW5nIHwgbnVsbDtcclxuICBsb2NhdGlvbjogc3RyaW5nIHwgbnVsbDtcclxuICBzb2NpYWxfbGlua3M6IFJlY29yZDxzdHJpbmcsIHVua25vd24+O1xyXG4gIHByZWZlcmVuY2VzOiBSZWNvcmQ8c3RyaW5nLCB1bmtub3duPjtcclxuICBpc19hY3RpdmU6IGJvb2xlYW47XHJcbiAgbGFzdF9sb2dpbl9hdDogc3RyaW5nIHwgbnVsbDtcclxuICBlbWFpbF92ZXJpZmllZDogYm9vbGVhbjtcclxuICBsYXN0X3NpZ25faW5fYXQ6IHN0cmluZyB8IG51bGw7XHJcbiAgY3JlYXRlZF9hdDogc3RyaW5nO1xyXG4gIHVwZGF0ZWRfYXQ6IHN0cmluZztcclxufVxyXG5cclxuYXN5bmMgZnVuY3Rpb24gaGFuZGxlcihyZXE6IE5leHRBcGlSZXF1ZXN0LCByZXM6IE5leHRBcGlSZXNwb25zZSkge1xyXG4gIC8vIEF1dGhlbnRpY2F0ZSB1c2VyIHVzaW5nIHRoZSBuZXcgbWlkZGxld2FyZVxyXG4gIGNvbnN0IHVzZXIgPSBhd2FpdCBhdXRoZW50aWNhdGUocmVxKTtcclxuXHJcbiAgLy8gR0VUIC0gVXNlciBwcm9maWxlXHJcbiAgaWYgKHJlcS5tZXRob2QgPT09ICdHRVQnKSB7XHJcbiAgICB0cnkge1xyXG4gICAgICBcclxuICAgICAgLy8gR2V0IHVzZXIgcHJvZmlsZSBmcm9tIGRhdGFiYXNlXHJcbiAgICAgIGxldCBwcm9maWxlOiBVc2VyUHJvZmlsZSB8IG51bGwgPSBudWxsO1xyXG4gICAgICBcclxuICAgICAgY29uc3QgeyBkYXRhOiBwcm9maWxlRGF0YSwgZXJyb3I6IHByb2ZpbGVFcnJvciB9ID0gYXdhaXQgc3VwYWJhc2VBZG1pblxyXG4gICAgICAgIC5mcm9tKCd1c2VycycpXHJcbiAgICAgICAgLnNlbGVjdCgnKicpXHJcbiAgICAgICAgLmVxKCdpZCcsIHVzZXIuaWQpXHJcbiAgICAgICAgLm1heWJlU2luZ2xlKCk7XHJcblxyXG4gICAgICAvLyBIYW5kbGUgY2FzZSB3aGVyZSBwcm9maWxlIGRvZXNuJ3QgZXhpc3Qgb3IgdGFibGUgZG9lc24ndCBleGlzdFxyXG4gICAgICBpZiAocHJvZmlsZUVycm9yKSB7XHJcbiAgICAgICAgLy8gSWYgdGFibGUgZG9lc24ndCBleGlzdCBvciBwZXJtaXNzaW9uIGRlbmllZCwgY3JlYXRlIGZhbGxiYWNrIHByb2ZpbGVcclxuICAgICAgICBpZiAocHJvZmlsZUVycm9yLmNvZGUgPT09ICdQR1JTVDExNicgfHwgXHJcbiAgICAgICAgICAgIHByb2ZpbGVFcnJvci5jb2RlID09PSAnNDI1MDEnIHx8IFxyXG4gICAgICAgICAgICBwcm9maWxlRXJyb3IubWVzc2FnZT8uaW5jbHVkZXMoJ2RvZXMgbm90IGV4aXN0JykgfHxcclxuICAgICAgICAgICAgcHJvZmlsZUVycm9yLm1lc3NhZ2U/LmluY2x1ZGVzKCdwZXJtaXNzaW9uIGRlbmllZCcpKSB7XHJcbiAgICAgICAgXHJcbiAgICAgICAgY29uc3QgYXV0aFJvbGUgPSB1c2VyLnJvbGU7XHJcbiAgICAgICAgXHJcbiAgICAgICAgcHJvZmlsZSA9IHtcclxuICAgICAgICAgIGlkOiB1c2VyLmlkLFxyXG4gICAgICAgICAgZW1haWw6IHVzZXIuZW1haWwgfHwgbnVsbCxcclxuICAgICAgICAgIG5hbWU6IHVzZXIuZW1haWw/LnNwbGl0KCdAJylbMF0gfHwgJ1VzZXInLFxyXG4gICAgICAgICAgcm9sZTogKGF1dGhSb2xlIGFzICd1c2VyJyB8ICdlZGl0b3InIHwgJ2FkbWluJykgfHwgJ3VzZXInLFxyXG4gICAgICAgICAgYXZhdGFyX3VybDogbnVsbCxcclxuICAgICAgICAgIGJpbzogbnVsbCxcclxuICAgICAgICAgIHdlYnNpdGU6IG51bGwsXHJcbiAgICAgICAgICBsb2NhdGlvbjogbnVsbCxcclxuICAgICAgICAgIHNvY2lhbF9saW5rczoge30sXHJcbiAgICAgICAgICBwcmVmZXJlbmNlczoge30sXHJcbiAgICAgICAgICBpc19hY3RpdmU6IHRydWUsXHJcbiAgICAgICAgICBsYXN0X2xvZ2luX2F0OiBuZXcgRGF0ZSgpLnRvSVNPU3RyaW5nKCksXHJcbiAgICAgICAgICBlbWFpbF92ZXJpZmllZDogZmFsc2UsXHJcbiAgICAgICAgICBsYXN0X3NpZ25faW5fYXQ6IG5ldyBEYXRlKCkudG9JU09TdHJpbmcoKSxcclxuICAgICAgICAgIGNyZWF0ZWRfYXQ6IG5ldyBEYXRlKCkudG9JU09TdHJpbmcoKSxcclxuICAgICAgICAgIHVwZGF0ZWRfYXQ6IG5ldyBEYXRlKCkudG9JU09TdHJpbmcoKSxcclxuICAgICAgICB9O1xyXG4gICAgICAgIH0gZWxzZSBpZiAocHJvZmlsZUVycm9yLmNvZGUgIT09ICdQR1JTVDExNicpIHtcclxuICAgICAgICAgIHJldHVybiByZXMuc3RhdHVzKDUwMCkuanNvbih7XHJcbiAgICAgICAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxyXG4gICAgICAgICAgICBlcnJvcjoge1xyXG4gICAgICAgICAgICAgIGNvZGU6ICdEQVRBQkFTRV9FUlJPUicsXHJcbiAgICAgICAgICAgICAgbWVzc2FnZTogJ0ZhaWxlZCB0byBmZXRjaCB1c2VyIHByb2ZpbGUnLFxyXG4gICAgICAgICAgICAgIGRldGFpbHM6IHByb2ZpbGVFcnJvci5tZXNzYWdlXHJcbiAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgIHRpbWVzdGFtcDogbmV3IERhdGUoKS50b0lTT1N0cmluZygpXHJcbiAgICAgICAgICB9KTtcclxuICAgICAgICB9XHJcbiAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgcHJvZmlsZSA9IHByb2ZpbGVEYXRhO1xyXG4gICAgICB9XHJcblxyXG4gICAgICAvLyBJZiBwcm9maWxlIGRvZXNuJ3QgZXhpc3QsIHRyeSB0byBjcmVhdGUgaXRcclxuICAgICAgaWYgKCFwcm9maWxlKSB7XHJcbiAgICAgICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIEB0eXBlc2NyaXB0LWVzbGludC9uby1leHBsaWNpdC1hbnlcclxuICAgICAgICBjb25zdCB7IGRhdGE6IG5ld1Byb2ZpbGUsIGVycm9yOiBjcmVhdGVFcnJvciB9ID0gYXdhaXQgKHN1cGFiYXNlQWRtaW4gYXMgYW55KVxyXG4gICAgICAgICAgLmZyb20oJ3VzZXJzJylcclxuICAgICAgICAgIC5pbnNlcnQoe1xyXG4gICAgICAgICAgICBpZDogdXNlci5pZCxcclxuICAgICAgICAgICAgZW1haWw6IHVzZXIuZW1haWwsXHJcbiAgICAgICAgICAgIG5hbWU6IHVzZXIuZW1haWw/LnNwbGl0KCdAJylbMF0gfHwgJ1VzZXInLFxyXG4gICAgICAgICAgICBiaW86IG51bGwsXHJcbiAgICAgICAgICAgIGF2YXRhcl91cmw6IG51bGwsXHJcbiAgICAgICAgICAgIHdlYnNpdGU6IG51bGwsXHJcbiAgICAgICAgICAgIGxvY2F0aW9uOiBudWxsLFxyXG4gICAgICAgICAgICBzb2NpYWxfbGlua3M6IHt9LFxyXG4gICAgICAgICAgICBwcmVmZXJlbmNlczoge30sXHJcbiAgICAgICAgICAgIHJvbGU6ICd1c2VyJyxcclxuICAgICAgICAgICAgaXNfYWN0aXZlOiB0cnVlLFxyXG4gICAgICAgICAgICBlbWFpbF92ZXJpZmllZDogZmFsc2UsXHJcbiAgICAgICAgICAgIGxhc3Rfc2lnbl9pbl9hdDogbmV3IERhdGUoKS50b0lTT1N0cmluZygpLFxyXG4gICAgICAgICAgICBjcmVhdGVkX2F0OiBuZXcgRGF0ZSgpLnRvSVNPU3RyaW5nKCksXHJcbiAgICAgICAgICAgIHVwZGF0ZWRfYXQ6IG5ldyBEYXRlKCkudG9JU09TdHJpbmcoKSxcclxuICAgICAgICAgIH0pXHJcbiAgICAgICAgICAuc2VsZWN0KCcqJylcclxuICAgICAgICAgIC5zaW5nbGUoKTtcclxuXHJcbiAgICAgICAgaWYgKGNyZWF0ZUVycm9yKSB7XHJcbiAgICAgICAgICAvLyBJZiBpdCdzIGEgY29uZmxpY3QsIHRyeSB0byBmZXRjaCBleGlzdGluZyBwcm9maWxlXHJcbiAgICAgICAgICBpZiAoY3JlYXRlRXJyb3IuY29kZSA9PT0gJzIzNTA1JyB8fCBjcmVhdGVFcnJvci5tZXNzYWdlPy5pbmNsdWRlcygnZHVwbGljYXRlJykpIHtcclxuICAgICAgICAgICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIEB0eXBlc2NyaXB0LWVzbGludC9uby1leHBsaWNpdC1hbnlcclxuICAgICAgICAgICAgY29uc3QgeyBkYXRhOiBleGlzdGluZ1Byb2ZpbGUsIGVycm9yOiBmZXRjaEVycm9yIH0gPSBhd2FpdCAoc3VwYWJhc2VBZG1pbiBhcyBhbnkpXHJcbiAgICAgICAgICAgICAgLmZyb20oJ3VzZXJzJylcclxuICAgICAgICAgICAgICAuc2VsZWN0KCcqJylcclxuICAgICAgICAgICAgICAuZXEoJ2lkJywgdXNlci5pZClcclxuICAgICAgICAgICAgICAuc2luZ2xlKCk7XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICBpZiAoIWZldGNoRXJyb3IgJiYgZXhpc3RpbmdQcm9maWxlKSB7XHJcbiAgICAgICAgICAgICAgcHJvZmlsZSA9IGV4aXN0aW5nUHJvZmlsZTtcclxuICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICBwcm9maWxlID0ge1xyXG4gICAgICAgICAgICAgICAgaWQ6IHVzZXIuaWQsXHJcbiAgICAgICAgICAgICAgICBlbWFpbDogdXNlci5lbWFpbCB8fCBudWxsLFxyXG4gICAgICAgICAgICAgICAgbmFtZTogdXNlci5lbWFpbD8uc3BsaXQoJ0AnKVswXSB8fCAnVXNlcicsXHJcbiAgICAgICAgICAgICAgICByb2xlOiAndXNlcicsXHJcbiAgICAgICAgICAgICAgICBhdmF0YXJfdXJsOiBudWxsLFxyXG4gICAgICAgICAgICAgICAgYmlvOiBudWxsLFxyXG4gICAgICAgICAgICAgICAgd2Vic2l0ZTogbnVsbCxcclxuICAgICAgICAgICAgICAgIGxvY2F0aW9uOiBudWxsLFxyXG4gICAgICAgICAgICAgICAgc29jaWFsX2xpbmtzOiB7fSxcclxuICAgICAgICAgICAgICAgIHByZWZlcmVuY2VzOiB7fSxcclxuICAgICAgICAgICAgICAgIGlzX2FjdGl2ZTogdHJ1ZSxcclxuICAgICAgICAgICAgICAgIGxhc3RfbG9naW5fYXQ6IG5ldyBEYXRlKCkudG9JU09TdHJpbmcoKSxcclxuICAgICAgICAgICAgICAgIGVtYWlsX3ZlcmlmaWVkOiBmYWxzZSxcclxuICAgICAgICAgICAgICAgIGxhc3Rfc2lnbl9pbl9hdDogbmV3IERhdGUoKS50b0lTT1N0cmluZygpLFxyXG4gICAgICAgICAgICAgICAgY3JlYXRlZF9hdDogbmV3IERhdGUoKS50b0lTT1N0cmluZygpLFxyXG4gICAgICAgICAgICAgICAgdXBkYXRlZF9hdDogbmV3IERhdGUoKS50b0lTT1N0cmluZygpLFxyXG4gICAgICAgICAgICAgIH07XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIHByb2ZpbGUgPSB7XHJcbiAgICAgICAgICAgICAgaWQ6IHVzZXIuaWQsXHJcbiAgICAgICAgICAgICAgZW1haWw6IHVzZXIuZW1haWwgfHwgbnVsbCxcclxuICAgICAgICAgICAgICBuYW1lOiB1c2VyLmVtYWlsPy5zcGxpdCgnQCcpWzBdIHx8ICdVc2VyJyxcclxuICAgICAgICAgICAgICByb2xlOiAndXNlcicsXHJcbiAgICAgICAgICAgICAgYXZhdGFyX3VybDogbnVsbCxcclxuICAgICAgICAgICAgICBiaW86IG51bGwsXHJcbiAgICAgICAgICAgICAgd2Vic2l0ZTogbnVsbCxcclxuICAgICAgICAgICAgICBsb2NhdGlvbjogbnVsbCxcclxuICAgICAgICAgICAgICBzb2NpYWxfbGlua3M6IHt9LFxyXG4gICAgICAgICAgICAgIHByZWZlcmVuY2VzOiB7fSxcclxuICAgICAgICAgICAgICBpc19hY3RpdmU6IHRydWUsXHJcbiAgICAgICAgICAgICAgbGFzdF9sb2dpbl9hdDogbmV3IERhdGUoKS50b0lTT1N0cmluZygpLFxyXG4gICAgICAgICAgICAgIGVtYWlsX3ZlcmlmaWVkOiBmYWxzZSxcclxuICAgICAgICAgICAgICBsYXN0X3NpZ25faW5fYXQ6IG5ldyBEYXRlKCkudG9JU09TdHJpbmcoKSxcclxuICAgICAgICAgICAgICBjcmVhdGVkX2F0OiBuZXcgRGF0ZSgpLnRvSVNPU3RyaW5nKCksXHJcbiAgICAgICAgICAgICAgdXBkYXRlZF9hdDogbmV3IERhdGUoKS50b0lTT1N0cmluZygpLFxyXG4gICAgICAgICAgICB9O1xyXG4gICAgICAgICAgfVxyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICBwcm9maWxlID0gbmV3UHJvZmlsZTtcclxuICAgICAgICB9XHJcbiAgICAgIH1cclxuXHJcbiAgICAgIC8vIEdldCB1c2VyIHN0YXRzICh3aXRoIGZhbGxiYWNrKVxyXG4gICAgICBsZXQgc3RhdHMgPSB7IGFydGljbGVzX2NvdW50OiAwLCBjb21tZW50c19jb3VudDogMCwgdG90YWxfdmlld3M6IDAsIHRvdGFsX2xpa2VzOiAwIH07XHJcblxyXG4gICAgICBpZiAocHJvZmlsZSkge1xyXG4gICAgICAgIHRyeSB7XHJcbiAgICAgICAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgQHR5cGVzY3JpcHQtZXNsaW50L25vLWV4cGxpY2l0LWFueVxyXG4gICAgICAgICAgY29uc3QgeyBkYXRhOiB1c2VyU3RhdHMsIGVycm9yOiBzdGF0c0Vycm9yIH0gPSBhd2FpdCAoc3VwYWJhc2VBZG1pbiBhcyBhbnkpXHJcbiAgICAgICAgICAgIC5mcm9tKCd1c2VyX3Byb2ZpbGVfc3RhdHMnKVxyXG4gICAgICAgICAgICAuc2VsZWN0KCdhcnRpY2xlc19jb3VudCwgY29tbWVudHNfY291bnQsIHRvdGFsX3ZpZXdzLCB0b3RhbF9saWtlcycpXHJcbiAgICAgICAgICAgIC5lcSgnaWQnLCB1c2VyLmlkKVxyXG4gICAgICAgICAgICAubWF5YmVTaW5nbGUoKTtcclxuXHJcbiAgICAgICAgICBpZiAoIXN0YXRzRXJyb3IgJiYgdXNlclN0YXRzKSB7XHJcbiAgICAgICAgICAgIHN0YXRzID0gdXNlclN0YXRzO1xyXG4gICAgICAgICAgfVxyXG4gICAgICAgIH0gY2F0Y2gge1xyXG4gICAgICAgICAgLy8gU3RhdHMgdGFibGUgbWlnaHQgbm90IGV4aXN0LCB1c2UgZGVmYXVsdHNcclxuICAgICAgICB9XHJcbiAgICAgIH1cclxuXHJcbiAgICAgIC8vIENvbWJpbmUgcHJvZmlsZSBkYXRhIHdpdGggc3RhdHNcclxuICAgICAgY29uc3QgcHJvZmlsZVdpdGhTdGF0cyA9IHtcclxuICAgICAgICAuLi5wcm9maWxlLFxyXG4gICAgICAgIGFydGljbGVfY291bnQ6IHN0YXRzLmFydGljbGVzX2NvdW50LFxyXG4gICAgICAgIGNvbW1lbnRfY291bnQ6IHN0YXRzLmNvbW1lbnRzX2NvdW50LFxyXG4gICAgICAgIHRvdGFsX3ZpZXdzOiBzdGF0cy50b3RhbF92aWV3cyxcclxuICAgICAgICB0b3RhbF9saWtlczogc3RhdHMudG90YWxfbGlrZXMsXHJcbiAgICAgIH07XHJcblxyXG4gICAgICAvLyBGSU5BTCBPVkVSUklERTogRW5zdXJlIGFkbWluIHJvbGUgZnJvbSBhdXRoZW50aWNhdGlvbiB0YWtlcyBwcmVjZWRlbmNlXHJcbiAgICAgIGlmICh1c2VyLnJvbGUgPT09ICdhZG1pbicpIHtcclxuICAgICAgICBwcm9maWxlV2l0aFN0YXRzLnJvbGUgPSAnYWRtaW4nO1xyXG4gICAgICB9XHJcblxyXG4gICAgICByZXR1cm4gcmVzLnN0YXR1cygyMDApLmpzb24oe1xyXG4gICAgICAgIHN1Y2Nlc3M6IHRydWUsXHJcbiAgICAgICAgZGF0YToge1xyXG4gICAgICAgICAgcHJvZmlsZTogcHJvZmlsZVdpdGhTdGF0cyxcclxuICAgICAgICAgIHN0YXRzOiBzdGF0c1xyXG4gICAgICAgIH0sXHJcbiAgICAgICAgdGltZXN0YW1wOiBuZXcgRGF0ZSgpLnRvSVNPU3RyaW5nKClcclxuICAgICAgfSk7XHJcblxyXG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgICAgcmV0dXJuIHJlcy5zdGF0dXMoNTAwKS5qc29uKHtcclxuICAgICAgICBzdWNjZXNzOiBmYWxzZSxcclxuICAgICAgICBlcnJvcjoge1xyXG4gICAgICAgICAgY29kZTogJ0lOVEVSTkFMX1NFUlZFUl9FUlJPUicsXHJcbiAgICAgICAgICBtZXNzYWdlOiAnQW4gdW5leHBlY3RlZCBlcnJvciBvY2N1cnJlZCB3aGlsZSBmZXRjaGluZyBwcm9maWxlJyxcclxuICAgICAgICAgIGRldGFpbHM6IHByb2Nlc3MuZW52Lk5PREVfRU5WID09PSAnZGV2ZWxvcG1lbnQnID8gKGVycm9yIGFzIEVycm9yKS5tZXNzYWdlIDogbnVsbFxyXG4gICAgICAgIH0sXHJcbiAgICAgICAgdGltZXN0YW1wOiBuZXcgRGF0ZSgpLnRvSVNPU3RyaW5nKClcclxuICAgICAgfSk7XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICAvLyBQVVQgLSBVcGRhdGUgdXNlciBwcm9maWxlXHJcbiAgaWYgKHJlcS5tZXRob2QgPT09ICdQVVQnKSB7XHJcbiAgICB0cnkge1xyXG4gICAgICAvLyBBcHBseSByYXRlIGxpbWl0aW5nXHJcbiAgICAgIHJhdGVMaW1pdE1pZGRsZXdhcmUocmVxKTtcclxuXHJcbiAgICAgIC8vIFZhbGlkYXRlIGFuZCBzYW5pdGl6ZSBpbnB1dFxyXG4gICAgICBwcm9maWxlVXBkYXRlU2NoZW1hLnBhcnNlKHJlcS5ib2R5KTtcclxuICAgICAgc2FuaXRpemVNaWRkbGV3YXJlKHJlcSk7XHJcbiAgICAgIGNvbnN0IHsgbmFtZSwgYmlvLCBhdmF0YXJfdXJsLCB3ZWJzaXRlLCBsb2NhdGlvbiwgc29jaWFsX2xpbmtzLCBwcmVmZXJlbmNlcyB9ID0gcmVxLmJvZHk7XHJcblxyXG4gICAgICAvLyBDaGVjayBpZiB1c2VyIGV4aXN0cyBpbiBkYXRhYmFzZVxyXG4gICAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgQHR5cGVzY3JpcHQtZXNsaW50L25vLWV4cGxpY2l0LWFueVxyXG4gICAgICBjb25zdCB7IGRhdGE6IGV4aXN0aW5nUHJvZmlsZSB9ID0gYXdhaXQgKHN1cGFiYXNlQWRtaW4gYXMgYW55KVxyXG4gICAgICAgIC5mcm9tKCd1c2VycycpXHJcbiAgICAgICAgLnNlbGVjdCgnaWQnKVxyXG4gICAgICAgIC5lcSgnaWQnLCB1c2VyLmlkKVxyXG4gICAgICAgIC5zaW5nbGUoKTtcclxuXHJcbiAgICAgIGNvbnN0IHVwZGF0ZURhdGE6IFJlY29yZDxzdHJpbmcsIHVua25vd24+ID0ge1xyXG4gICAgICAgIG5hbWU6IG5hbWUudHJpbSgpLFxyXG4gICAgICAgIHVwZGF0ZWRfYXQ6IG5ldyBEYXRlKCkudG9JU09TdHJpbmcoKVxyXG4gICAgICB9O1xyXG5cclxuICAgICAgLy8gT3B0aW9uYWwgZmllbGRzXHJcbiAgICAgIGlmIChiaW8gIT09IHVuZGVmaW5lZCkge1xyXG4gICAgICAgIHVwZGF0ZURhdGEuYmlvID0gdHlwZW9mIGJpbyA9PT0gJ3N0cmluZycgPyBiaW8udHJpbSgpIDogbnVsbDtcclxuICAgICAgfVxyXG4gICAgICBcclxuICAgICAgaWYgKGF2YXRhcl91cmwgIT09IHVuZGVmaW5lZCkge1xyXG4gICAgICAgIHVwZGF0ZURhdGEuYXZhdGFyX3VybCA9IGF2YXRhcl91cmwgfHwgbnVsbDtcclxuICAgICAgfVxyXG5cclxuICAgICAgaWYgKHdlYnNpdGUgIT09IHVuZGVmaW5lZCkge1xyXG4gICAgICAgIHVwZGF0ZURhdGEud2Vic2l0ZSA9IHdlYnNpdGUgJiYgdHlwZW9mIHdlYnNpdGUgPT09ICdzdHJpbmcnID8gd2Vic2l0ZS50cmltKCkgOiBudWxsO1xyXG4gICAgICB9XHJcblxyXG4gICAgICBpZiAobG9jYXRpb24gIT09IHVuZGVmaW5lZCkge1xyXG4gICAgICAgIHVwZGF0ZURhdGEubG9jYXRpb24gPSBsb2NhdGlvbiAmJiB0eXBlb2YgbG9jYXRpb24gPT09ICdzdHJpbmcnID8gbG9jYXRpb24udHJpbSgpIDogbnVsbDtcclxuICAgICAgfVxyXG5cclxuICAgICAgaWYgKHNvY2lhbF9saW5rcyAhPT0gdW5kZWZpbmVkKSB7XHJcbiAgICAgICAgdXBkYXRlRGF0YS5zb2NpYWxfbGlua3MgPSB0eXBlb2Ygc29jaWFsX2xpbmtzID09PSAnb2JqZWN0JyA/IHNvY2lhbF9saW5rcyA6IHt9O1xyXG4gICAgICB9XHJcblxyXG4gICAgICBpZiAocHJlZmVyZW5jZXMgIT09IHVuZGVmaW5lZCkge1xyXG4gICAgICAgIHVwZGF0ZURhdGEucHJlZmVyZW5jZXMgPSB0eXBlb2YgcHJlZmVyZW5jZXMgPT09ICdvYmplY3QnID8gcHJlZmVyZW5jZXMgOiB7fTtcclxuICAgICAgfVxyXG5cclxuICAgICAgbGV0IHJlc3VsdDtcclxuICAgICAgbGV0IHByb2ZpbGVFcnJvcjtcclxuICAgICAgXHJcbiAgICAgIGlmIChleGlzdGluZ1Byb2ZpbGUpIHtcclxuICAgICAgICAvLyBVcGRhdGUgZXhpc3RpbmcgcHJvZmlsZVxyXG4gICAgICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBAdHlwZXNjcmlwdC1lc2xpbnQvbm8tZXhwbGljaXQtYW55XHJcbiAgICAgICAgKHsgZGF0YTogcmVzdWx0LCBlcnJvcjogcHJvZmlsZUVycm9yIH0gPSBhd2FpdCAoc3VwYWJhc2VBZG1pbiBhcyBhbnkpXHJcbiAgICAgICAgICAuZnJvbSgndXNlcnMnKVxyXG4gICAgICAgICAgLnVwZGF0ZSh1cGRhdGVEYXRhKVxyXG4gICAgICAgICAgLmVxKCdpZCcsIHVzZXIuaWQpXHJcbiAgICAgICAgICAuc2VsZWN0KCcqJylcclxuICAgICAgICAgIC5zaW5nbGUoKSk7XHJcbiAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgLy8gQ3JlYXRlIG5ldyBwcm9maWxlXHJcbiAgICAgICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIEB0eXBlc2NyaXB0LWVzbGludC9uby1leHBsaWNpdC1hbnlcclxuICAgICAgICAoeyBkYXRhOiByZXN1bHQsIGVycm9yOiBwcm9maWxlRXJyb3IgfSA9IGF3YWl0IChzdXBhYmFzZUFkbWluIGFzIGFueSlcclxuICAgICAgICAgIC5mcm9tKCd1c2VycycpXHJcbiAgICAgICAgICAuaW5zZXJ0KHtcclxuICAgICAgICAgICAgaWQ6IHVzZXIuaWQsXHJcbiAgICAgICAgICAgIGVtYWlsOiB1c2VyLmVtYWlsLFxyXG4gICAgICAgICAgICBuYW1lOiBuYW1lLnRyaW0oKSxcclxuICAgICAgICAgICAgYmlvOiBiaW8/LnRyaW0oKSB8fCBudWxsLFxyXG4gICAgICAgICAgICBhdmF0YXJfdXJsOiBhdmF0YXJfdXJsIHx8IG51bGwsXHJcbiAgICAgICAgICAgIHdlYnNpdGU6IHdlYnNpdGU/LnRyaW0oKSB8fCBudWxsLFxyXG4gICAgICAgICAgICBsb2NhdGlvbjogbG9jYXRpb24/LnRyaW0oKSB8fCBudWxsLFxyXG4gICAgICAgICAgICBzb2NpYWxfbGlua3M6IHNvY2lhbF9saW5rcyB8fCB7fSxcclxuICAgICAgICAgICAgcHJlZmVyZW5jZXM6IHByZWZlcmVuY2VzIHx8IHt9LFxyXG4gICAgICAgICAgICByb2xlOiAndXNlcicsXHJcbiAgICAgICAgICAgIGlzX2FjdGl2ZTogdHJ1ZSxcclxuICAgICAgICAgICAgY3JlYXRlZF9hdDogbmV3IERhdGUoKS50b0lTT1N0cmluZygpLFxyXG4gICAgICAgICAgICB1cGRhdGVkX2F0OiBuZXcgRGF0ZSgpLnRvSVNPU3RyaW5nKCksXHJcbiAgICAgICAgICB9KVxyXG4gICAgICAgICAgLnNlbGVjdCgnKicpXHJcbiAgICAgICAgICAuc2luZ2xlKCkpO1xyXG4gICAgICB9XHJcblxyXG4gICAgICBpZiAocHJvZmlsZUVycm9yKSB7XHJcbiAgICAgICAgcmV0dXJuIHJlcy5zdGF0dXMoNTAwKS5qc29uKHtcclxuICAgICAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxyXG4gICAgICAgICAgZXJyb3I6IHtcclxuICAgICAgICAgICAgY29kZTogJ1BST0ZJTEVfVVBEQVRFX0ZBSUxFRCcsXHJcbiAgICAgICAgICAgIG1lc3NhZ2U6ICdGYWlsZWQgdG8gdXBkYXRlIHVzZXIgcHJvZmlsZScsXHJcbiAgICAgICAgICAgIGRldGFpbHM6IHByb2ZpbGVFcnJvci5tZXNzYWdlXHJcbiAgICAgICAgICB9LFxyXG4gICAgICAgICAgdGltZXN0YW1wOiBuZXcgRGF0ZSgpLnRvSVNPU3RyaW5nKClcclxuICAgICAgICB9KTtcclxuICAgICAgfVxyXG5cclxuICAgICAgLy8gR2V0IHVwZGF0ZWQgc3RhdHNcclxuICAgICAgbGV0IHN0YXRzID0geyBhcnRpY2xlc19jb3VudDogMCwgY29tbWVudHNfY291bnQ6IDAsIHRvdGFsX3ZpZXdzOiAwLCB0b3RhbF9saWtlczogMCB9O1xyXG4gICAgICB0cnkge1xyXG4gICAgICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBAdHlwZXNjcmlwdC1lc2xpbnQvbm8tZXhwbGljaXQtYW55XHJcbiAgICAgICAgY29uc3QgeyBkYXRhOiB1c2VyU3RhdHMsIGVycm9yOiBzdGF0c0Vycm9yIH0gPSBhd2FpdCAoc3VwYWJhc2VBZG1pbiBhcyBhbnkpXHJcbiAgICAgICAgICAuZnJvbSgndXNlcl9wcm9maWxlX3N0YXRzJylcclxuICAgICAgICAgIC5zZWxlY3QoJyonKVxyXG4gICAgICAgICAgLmVxKCdpZCcsIHVzZXIuaWQpXHJcbiAgICAgICAgICAuc2luZ2xlKCk7XHJcblxyXG4gICAgICAgIGlmICghc3RhdHNFcnJvciAmJiB1c2VyU3RhdHMpIHtcclxuICAgICAgICAgIHN0YXRzID0ge1xyXG4gICAgICAgICAgICBhcnRpY2xlc19jb3VudDogdXNlclN0YXRzLmFydGljbGVzX2NvdW50IHx8IDAsXHJcbiAgICAgICAgICAgIGNvbW1lbnRzX2NvdW50OiB1c2VyU3RhdHMuY29tbWVudHNfY291bnQgfHwgMCxcclxuICAgICAgICAgICAgdG90YWxfdmlld3M6IHVzZXJTdGF0cy50b3RhbF92aWV3cyB8fCAwLFxyXG4gICAgICAgICAgICB0b3RhbF9saWtlczogdXNlclN0YXRzLnRvdGFsX2xpa2VzIHx8IDAsXHJcbiAgICAgICAgICB9O1xyXG4gICAgICAgIH1cclxuICAgICAgfSBjYXRjaCB7XHJcbiAgICAgICAgLy8gU3RhdHMgcXVlcnkgZmFpbGVkLCBidXQgZG9uJ3QgZmFpbCB0aGUgZW50aXJlIHJlcXVlc3RcclxuICAgICAgfVxyXG5cclxuICAgICAgLy8gQ29tYmluZSBwcm9maWxlIGRhdGEgd2l0aCBzdGF0c1xyXG4gICAgICBjb25zdCBwcm9maWxlV2l0aFN0YXRzID0ge1xyXG4gICAgICAgIC4uLnJlc3VsdCxcclxuICAgICAgICBhcnRpY2xlX2NvdW50OiBzdGF0cy5hcnRpY2xlc19jb3VudCxcclxuICAgICAgICBjb21tZW50X2NvdW50OiBzdGF0cy5jb21tZW50c19jb3VudCxcclxuICAgICAgICB0b3RhbF92aWV3czogc3RhdHMudG90YWxfdmlld3MsXHJcbiAgICAgICAgdG90YWxfbGlrZXM6IHN0YXRzLnRvdGFsX2xpa2VzLFxyXG4gICAgICB9O1xyXG5cclxuICAgICAgcmV0dXJuIHJlcy5zdGF0dXMoMjAwKS5qc29uKHtcclxuICAgICAgICBzdWNjZXNzOiB0cnVlLFxyXG4gICAgICAgIGRhdGE6IHtcclxuICAgICAgICAgIHByb2ZpbGU6IHByb2ZpbGVXaXRoU3RhdHMsXHJcbiAgICAgICAgICBzdGF0czogc3RhdHNcclxuICAgICAgICB9LFxyXG4gICAgICAgIHRpbWVzdGFtcDogbmV3IERhdGUoKS50b0lTT1N0cmluZygpXHJcbiAgICAgIH0pO1xyXG5cclxuICAgIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICAgIGNvbnNvbGUuZXJyb3IoJ1Byb2ZpbGUgUFVUIGVycm9yOicsIGVycm9yKTtcclxuICAgICAgcmV0dXJuIHJlcy5zdGF0dXMoNTAwKS5qc29uKHtcclxuICAgICAgICBzdWNjZXNzOiBmYWxzZSxcclxuICAgICAgICBlcnJvcjoge1xyXG4gICAgICAgICAgY29kZTogJ0lOVEVSTkFMX1NFUlZFUl9FUlJPUicsXHJcbiAgICAgICAgICBtZXNzYWdlOiAnQW4gdW5leHBlY3RlZCBlcnJvciBvY2N1cnJlZCB3aGlsZSB1cGRhdGluZyBwcm9maWxlJyxcclxuICAgICAgICAgIGRldGFpbHM6IHByb2Nlc3MuZW52Lk5PREVfRU5WID09PSAnZGV2ZWxvcG1lbnQnID8gKGVycm9yIGFzIEVycm9yKS5tZXNzYWdlIDogbnVsbFxyXG4gICAgICAgIH0sXHJcbiAgICAgICAgdGltZXN0YW1wOiBuZXcgRGF0ZSgpLnRvSVNPU3RyaW5nKClcclxuICAgICAgfSk7XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICByZXR1cm4gcmVzLnN0YXR1cyg0MDUpLmpzb24oe1xyXG4gICAgc3VjY2VzczogZmFsc2UsXHJcbiAgICBlcnJvcjoge1xyXG4gICAgICBjb2RlOiAnTUVUSE9EX05PVF9BTExPV0VEJyxcclxuICAgICAgbWVzc2FnZTogJ09ubHkgR0VUIGFuZCBQVVQgbWV0aG9kcyBhcmUgYWxsb3dlZCcsXHJcbiAgICAgIGRldGFpbHM6IG51bGxcclxuICAgIH0sXHJcbiAgICB0aW1lc3RhbXA6IG5ldyBEYXRlKCkudG9JU09TdHJpbmcoKVxyXG4gIH0pO1xyXG59XHJcblxyXG4vLyBXcmFwIHdpdGggZXJyb3IgaGFuZGxlciBtaWRkbGV3YXJlXHJcbmV4cG9ydCBkZWZhdWx0IHdpdGhFcnJvckhhbmRsZXIoaGFuZGxlcik7XHJcblxyXG4iXSwibmFtZXMiOlsic3VwYWJhc2VBZG1pbiIsIndpdGhFcnJvckhhbmRsZXIiLCJhdXRoZW50aWNhdGUiLCJ3aXRoUmF0ZUxpbWl0IiwieiIsInByb2ZpbGVVcGRhdGVTY2hlbWEiLCJvYmplY3QiLCJuYW1lIiwic3RyaW5nIiwibWluIiwibWF4IiwiYmlvIiwib3B0aW9uYWwiLCJudWxsYWJsZSIsImF2YXRhcl91cmwiLCJ1cmwiLCJ3ZWJzaXRlIiwibG9jYXRpb24iLCJzb2NpYWxfbGlua3MiLCJyZWNvcmQiLCJ1bmtub3duIiwicHJlZmVyZW5jZXMiLCJyYXRlTGltaXRNaWRkbGV3YXJlIiwicmVxIiwidG9rZW4iLCJoZWFkZXJzIiwiYXV0aG9yaXphdGlvbiIsInJlcGxhY2UiLCJzb2NrZXQiLCJyZW1vdGVBZGRyZXNzIiwic2FuaXRpemVNaWRkbGV3YXJlIiwiZmllbGRzIiwiZm9yRWFjaCIsImZpZWxkIiwiYm9keSIsInRyaW0iLCJoYW5kbGVyIiwicmVzIiwidXNlciIsIm1ldGhvZCIsInByb2ZpbGUiLCJkYXRhIiwicHJvZmlsZURhdGEiLCJlcnJvciIsInByb2ZpbGVFcnJvciIsImZyb20iLCJzZWxlY3QiLCJlcSIsImlkIiwibWF5YmVTaW5nbGUiLCJjb2RlIiwibWVzc2FnZSIsImluY2x1ZGVzIiwiYXV0aFJvbGUiLCJyb2xlIiwiZW1haWwiLCJzcGxpdCIsImlzX2FjdGl2ZSIsImxhc3RfbG9naW5fYXQiLCJEYXRlIiwidG9JU09TdHJpbmciLCJlbWFpbF92ZXJpZmllZCIsImxhc3Rfc2lnbl9pbl9hdCIsImNyZWF0ZWRfYXQiLCJ1cGRhdGVkX2F0Iiwic3RhdHVzIiwianNvbiIsInN1Y2Nlc3MiLCJkZXRhaWxzIiwidGltZXN0YW1wIiwibmV3UHJvZmlsZSIsImNyZWF0ZUVycm9yIiwiaW5zZXJ0Iiwic2luZ2xlIiwiZXhpc3RpbmdQcm9maWxlIiwiZmV0Y2hFcnJvciIsInN0YXRzIiwiYXJ0aWNsZXNfY291bnQiLCJjb21tZW50c19jb3VudCIsInRvdGFsX3ZpZXdzIiwidG90YWxfbGlrZXMiLCJ1c2VyU3RhdHMiLCJzdGF0c0Vycm9yIiwicHJvZmlsZVdpdGhTdGF0cyIsImFydGljbGVfY291bnQiLCJjb21tZW50X2NvdW50IiwicHJvY2VzcyIsInBhcnNlIiwidXBkYXRlRGF0YSIsInVuZGVmaW5lZCIsInJlc3VsdCIsInVwZGF0ZSIsImNvbnNvbGUiXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(api)/./pages/api/user/profile.ts\n");

/***/ })

};
;

// load runtime
var __webpack_require__ = require("../../../webpack-api-runtime.js");
__webpack_require__.C(exports);
var __webpack_exec__ = (moduleId) => (__webpack_require__(__webpack_require__.s = moduleId))
var __webpack_exports__ = __webpack_require__.X(0, ["vendor-chunks/next@14.2.33_@babel+core@7._c7975f2ee2cecff60ee055e1f1f303a8"], () => (__webpack_exec__("(api)/../../node_modules/.pnpm/next@14.2.33_@babel+core@7._c7975f2ee2cecff60ee055e1f1f303a8/node_modules/next/dist/build/webpack/loaders/next-route-loader/index.js?kind=PAGES_API&page=%2Fapi%2Fuser%2Fprofile&preferredRegion=&absolutePagePath=.%2Fpages%5Capi%5Cuser%5Cprofile.ts&middlewareConfigBase64=e30%3D!")));
module.exports = __webpack_exports__;

})();